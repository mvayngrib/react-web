





'use strict';

var _ReactPromise=require('../Promise/Promise.web');var _ReactPromise2=_interopRequireDefault(_ReactPromise);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}


if(!self.fetch){var






































































































support;var

























































































methods;var








































































































redirectStatuses;(function(){function normalizeName(name){if(typeof name!=='string'){name=String(name);}if(/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(name)){throw new TypeError('Invalid character in header field name');}return name.toLowerCase();}function normalizeValue(value){if(typeof value!=='string'){value=String(value);}return value;}function Headers(headers){this.map={};if(headers instanceof Headers){headers.forEach(function(value,name){this.append(name,value);},this);}else if(headers){Object.getOwnPropertyNames(headers).forEach(function(name){this.append(name,headers[name]);},this);}}Headers.prototype.append=function(name,value){name=normalizeName(name);value=normalizeValue(value);var list=this.map[name];if(!list){list=[];this.map[name]=list;}list.push(value);};Headers.prototype['delete']=function(name){delete this.map[normalizeName(name)];};Headers.prototype.get=function(name){var values=this.map[normalizeName(name)];return values?values[0]:null;};Headers.prototype.getAll=function(name){return this.map[normalizeName(name)]||[];};Headers.prototype.has=function(name){return this.map.hasOwnProperty(normalizeName(name));};Headers.prototype.set=function(name,value){this.map[normalizeName(name)]=[normalizeValue(value)];};Headers.prototype.forEach=function(callback,thisArg){Object.getOwnPropertyNames(this.map).forEach(function(name){this.map[name].forEach(function(value){callback.call(thisArg,value,name,this);},this);},this);};function consumed(body){if(body.bodyUsed){return _ReactPromise2.default.reject(new TypeError('Already read'));}body.bodyUsed=true;}function fileReaderReady(reader){return new _ReactPromise2.default(function(resolve,reject){reader.onload=function(){resolve(reader.result);};reader.onerror=function(){reject(reader.error);};});}function readBlobAsArrayBuffer(blob){var reader=new FileReader();reader.readAsArrayBuffer(blob);return fileReaderReady(reader);}function readBlobAsText(blob){var reader=new FileReader();reader.readAsText(blob);return fileReaderReady(reader);}support={blob:'FileReader'in self&&'Blob'in self&&function(){try{new Blob();return true;}catch(e){return false;}}(),formData:'FormData'in self,arrayBuffer:'ArrayBuffer'in self};function Body(){this.bodyUsed=false;this._initBody=function(body){this._bodyInit=body;if(typeof body==='string'){this._bodyText=body;}else if(support.blob&&Blob.prototype.isPrototypeOf(body)){this._bodyBlob=body;}else if(support.formData&&FormData.prototype.isPrototypeOf(body)){this._bodyFormData=body;}else if(!body){this._bodyText='';}else if(support.arrayBuffer&&ArrayBuffer.prototype.isPrototypeOf(body)){}else{throw new Error('unsupported BodyInit type');}};if(support.blob){this.blob=function(){var rejected=consumed(this);if(rejected){return rejected;}if(this._bodyBlob){return _ReactPromise2.default.resolve(this._bodyBlob);}else if(this._bodyFormData){throw new Error('could not read FormData body as blob');}else{return _ReactPromise2.default.resolve(new Blob([this._bodyText]));}};this.arrayBuffer=function(){return this.blob().then(readBlobAsArrayBuffer);};this.text=function(){var rejected=consumed(this);if(rejected){return rejected;}if(this._bodyBlob){return readBlobAsText(this._bodyBlob);}else if(this._bodyFormData){throw new Error('could not read FormData body as text');}else{return _ReactPromise2.default.resolve(this._bodyText);}};}else{this.text=function(){var rejected=consumed(this);return rejected?rejected:_ReactPromise2.default.resolve(this._bodyText);};}if(support.formData){this.formData=function(){return this.text().then(decode);};}this.json=function(){return this.text().then(JSON.parse);};return this;}methods=['DELETE','GET','HEAD','OPTIONS','POST','PUT'];function normalizeMethod(method){var upcased=method.toUpperCase();return methods.indexOf(upcased)>-1?upcased:method;}function Request(input,options){options=options||{};var body=options.body;if(Request.prototype.isPrototypeOf(input)){if(input.bodyUsed){throw new TypeError('Already read');}this.url=input.url;this.credentials=input.credentials;if(!options.headers){this.headers=new Headers(input.headers);}this.method=input.method;this.mode=input.mode;if(!body){body=input._bodyInit;input.bodyUsed=true;}}else{this.url=input;}this.credentials=options.credentials||this.credentials||'omit';if(options.headers||!this.headers){this.headers=new Headers(options.headers);}this.method=normalizeMethod(options.method||this.method||'GET');this.mode=options.mode||this.mode||null;this.referrer=null;if((this.method==='GET'||this.method==='HEAD')&&body){throw new TypeError('Body not allowed for GET or HEAD requests');}this._initBody(body);}Request.prototype.clone=function(){return new Request(this);};function decode(body){var form=new FormData();body.trim().split('&').forEach(function(bytes){if(bytes){var split=bytes.split('=');var name=split.shift().replace(/\+/g,' ');var value=split.join('=').replace(/\+/g,' ');form.append(decodeURIComponent(name),decodeURIComponent(value));}});return form;}function headers(xhr){var head=new Headers();var pairs=xhr.getAllResponseHeaders().trim().split('\n');pairs.forEach(function(header){var split=header.trim().split(':');var key=split.shift().trim();var value=split.join(':').trim();head.append(key,value);});return head;}Body.call(Request.prototype);function Response(bodyInit,options){if(!options){options={};}this._initBody(bodyInit);this.type='default';this.status=options.status;this.ok=this.status>=200&&this.status<300;this.statusText=options.statusText;this.headers=options.headers instanceof Headers?options.headers:new Headers(options.headers);this.url=options.url||'';}Body.call(Response.prototype);Response.prototype.clone=function(){return new Response(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new Headers(this.headers),url:this.url});};Response.error=function(){var response=new Response(null,{status:0,statusText:''});response.type='error';return response;};redirectStatuses=[301,302,303,307,308];

Response.redirect=function(url,status){
if(redirectStatuses.indexOf(status)===-1){
throw new RangeError('Invalid status code');
}

return new Response(null,{status:status,headers:{location:url}});
};

self.Headers=Headers;
self.Request=Request;
self.Response=Response;

self.fetch=function(input,init){
return new _ReactPromise2.default(function(resolve,reject){
var request;
if(Request.prototype.isPrototypeOf(input)&&!init){
request=input;
}else{
request=new Request(input,init);
}

var xhr=new XMLHttpRequest();

function responseURL(){
if('responseURL'in xhr){
return xhr.responseURL;
}


if(/^X-Request-URL:/m.test(xhr.getAllResponseHeaders())){
return xhr.getResponseHeader('X-Request-URL');
}

return;
}

xhr.onload=function(){
var status=xhr.status===1223?204:xhr.status;
if(status<100||status>599){
reject(new TypeError('Network request failed'));
return;
}
var options={
status:status,
statusText:xhr.statusText,
headers:headers(xhr),
url:responseURL()};

var body='response'in xhr?xhr.response:xhr.responseText;
resolve(new Response(body,options));
};

xhr.onerror=function(){
reject(new TypeError('Network request failed'));
};

xhr.open(request.method,request.url,true);

if(request.credentials==='include'){
xhr.withCredentials=true;
}

if('responseType'in xhr&&support.blob){
xhr.responseType='blob';
}

request.headers.forEach(function(value,name){
xhr.setRequestHeader(name,value);
});

xhr.send(typeof request._bodyInit==='undefined'?null:request._bodyInit);
});
};

self.fetch.polyfill=true;})();
}

module.exports=self.fetch;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkZldGNoLndlYi5qcyJdLCJuYW1lcyI6WyJzZWxmIiwiZmV0Y2giLCJzdXBwb3J0IiwibWV0aG9kcyIsInJlZGlyZWN0U3RhdHVzZXMiLCJub3JtYWxpemVOYW1lIiwibmFtZSIsIlN0cmluZyIsInRlc3QiLCJUeXBlRXJyb3IiLCJ0b0xvd2VyQ2FzZSIsIm5vcm1hbGl6ZVZhbHVlIiwidmFsdWUiLCJIZWFkZXJzIiwiaGVhZGVycyIsIm1hcCIsImZvckVhY2giLCJhcHBlbmQiLCJPYmplY3QiLCJnZXRPd25Qcm9wZXJ0eU5hbWVzIiwicHJvdG90eXBlIiwibGlzdCIsInB1c2giLCJnZXQiLCJ2YWx1ZXMiLCJnZXRBbGwiLCJoYXMiLCJoYXNPd25Qcm9wZXJ0eSIsInNldCIsImNhbGxiYWNrIiwidGhpc0FyZyIsImNhbGwiLCJjb25zdW1lZCIsImJvZHkiLCJib2R5VXNlZCIsInJlamVjdCIsImZpbGVSZWFkZXJSZWFkeSIsInJlYWRlciIsInJlc29sdmUiLCJvbmxvYWQiLCJyZXN1bHQiLCJvbmVycm9yIiwiZXJyb3IiLCJyZWFkQmxvYkFzQXJyYXlCdWZmZXIiLCJibG9iIiwiRmlsZVJlYWRlciIsInJlYWRBc0FycmF5QnVmZmVyIiwicmVhZEJsb2JBc1RleHQiLCJyZWFkQXNUZXh0IiwiQmxvYiIsImUiLCJmb3JtRGF0YSIsImFycmF5QnVmZmVyIiwiQm9keSIsIl9pbml0Qm9keSIsIl9ib2R5SW5pdCIsIl9ib2R5VGV4dCIsImlzUHJvdG90eXBlT2YiLCJfYm9keUJsb2IiLCJGb3JtRGF0YSIsIl9ib2R5Rm9ybURhdGEiLCJBcnJheUJ1ZmZlciIsIkVycm9yIiwicmVqZWN0ZWQiLCJ0aGVuIiwidGV4dCIsImRlY29kZSIsImpzb24iLCJKU09OIiwicGFyc2UiLCJub3JtYWxpemVNZXRob2QiLCJtZXRob2QiLCJ1cGNhc2VkIiwidG9VcHBlckNhc2UiLCJpbmRleE9mIiwiUmVxdWVzdCIsImlucHV0Iiwib3B0aW9ucyIsInVybCIsImNyZWRlbnRpYWxzIiwibW9kZSIsInJlZmVycmVyIiwiY2xvbmUiLCJmb3JtIiwidHJpbSIsInNwbGl0IiwiYnl0ZXMiLCJzaGlmdCIsInJlcGxhY2UiLCJqb2luIiwiZGVjb2RlVVJJQ29tcG9uZW50IiwieGhyIiwiaGVhZCIsInBhaXJzIiwiZ2V0QWxsUmVzcG9uc2VIZWFkZXJzIiwiaGVhZGVyIiwia2V5IiwiUmVzcG9uc2UiLCJib2R5SW5pdCIsInR5cGUiLCJzdGF0dXMiLCJvayIsInN0YXR1c1RleHQiLCJyZXNwb25zZSIsInJlZGlyZWN0IiwiUmFuZ2VFcnJvciIsImxvY2F0aW9uIiwiaW5pdCIsInJlcXVlc3QiLCJYTUxIdHRwUmVxdWVzdCIsInJlc3BvbnNlVVJMIiwiZ2V0UmVzcG9uc2VIZWFkZXIiLCJyZXNwb25zZVRleHQiLCJvcGVuIiwid2l0aENyZWRlbnRpYWxzIiwicmVzcG9uc2VUeXBlIiwic2V0UmVxdWVzdEhlYWRlciIsInNlbmQiLCJwb2x5ZmlsbCIsIm1vZHVsZSIsImV4cG9ydHMiXSwibWFwcGluZ3MiOiI7Ozs7OztBQU1BOztBQUVBLG9EOzs7QUFHQSxHQUFJLENBQUNBLEtBQUtDLEtBQVYsQ0FBaUI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUF1R1hDLE9BdkdXOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFpTVhDLE9Bak1XOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUEwU1hDLGdCQTFTVyxhQUNmLFFBQVNDLGNBQVQsQ0FBdUJDLElBQXZCLENBQTZCLENBQzNCLEdBQUksTUFBT0Es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QUlBK0UsSUFBSTBCLElBQUosQ0FBUyxNQUFPVCxTQUFRckQsU0FBZixHQUE2QixXQUE3QixDQUEyQyxJQUEzQyxDQUFrRHFELFFBQVFyRCxTQUFuRTtBQUNELENBMURNLENBQVA7QUEyREQsQ0E1REQ7O0FBOERBdkQsS0FBS0MsS0FBTCxDQUFXcUgsUUFBWCxDQUFzQixJQUF0QixDQXRYZTtBQXVYaEI7O0FBRURDLE9BQU9DLE9BQVAsQ0FBaUJ4SCxLQUFLQyxLQUF0QiIsImZpbGUiOiJGZXRjaC53ZWIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBBbGliYWJhIEdyb3VwIEhvbGRpbmcgTGltaXRlZC5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogQHByb3ZpZGVzTW9kdWxlIFJlYWN0RmV0Y2hcbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgUHJvbWlzZSBmcm9tICdSZWFjdFByb21pc2UnO1xuXG4vLyBodHRwczovL2dpdGh1Yi5jb20vZ2l0aHViL2ZldGNoXG5pZiAoIXNlbGYuZmV0Y2gpIHtcbiAgZnVuY3Rpb24gbm9ybWFsaXplTmFtZShuYW1lKSB7XG4gICAgaWYgKHR5cGVvZiBuYW1lICE9PSAnc3RyaW5nJykge1xuICAgICAgbmFtZSA9IFN0cmluZyhuYW1lKVxuICAgIH1cbiAgICBpZiAoL1teYS16MC05XFwtIyQlJicqKy5cXF5fYHx+XS9pLnRlc3QobmFtZSkpIHtcbiAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0ludmFsaWQgY2hhcmFjdGVyIGluIGhlYWRlciBmaWVsZCBuYW1lJylcbiAgICB9XG4gICAgcmV0dXJuIG5hbWUudG9Mb3dlckNhc2UoKVxuICB9XG5cbiAgZnVuY3Rpb24gbm9ybWFsaXplVmFsdWUodmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlICE9PSAnc3RyaW5nJykge1xuICAgICAgdmFsdWUgPSBTdHJpbmcodmFsdWUpXG4gICAgfVxuICAgIHJldHVybiB2YWx1ZVxuICB9XG5cbiAgZnVuY3Rpb24gSGVhZGVycyhoZWFkZXJzKSB7XG4gICAgdGhpcy5tYXAgPSB7fVxuXG4gICAgaWYgKGhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzKSB7XG4gICAgICBoZWFkZXJzLmZvckVhY2goZnVuY3Rpb24odmFsdWUsIG5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgdmFsdWUpXG4gICAgICB9LCB0aGlzKVxuXG4gICAgfSBlbHNlIGlmIChoZWFkZXJzKSB7XG4gICAgICBPYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyhoZWFkZXJzKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgICAgdGhpcy5hcHBlbmQobmFtZSwgaGVhZGVyc1tuYW1lXSlcbiAgICAgIH0sIHRoaXMpXG4gICAgfVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuYXBwZW5kID0gZnVuY3Rpb24obmFtZSwgdmFsdWUpIHtcbiAgICBuYW1lID0gbm9ybWFsaXplTmFtZShuYW1lKVxuICAgIHZhbHVlID0gbm9ybWFsaXplVmFsdWUodmFsdWUpXG4gICAgdmFyIGxpc3QgPSB0aGlzLm1hcFtuYW1lXVxuICAgIGlmICghbGlzdCkge1xuICAgICAgbGlzdCA9IFtdXG4gICAgICB0aGlzLm1hcFtuYW1lXSA9IGxpc3RcbiAgICB9XG4gICAgbGlzdC5wdXNoKHZhbHVlKVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGVbJ2RlbGV0ZSddID0gZnVuY3Rpb24obmFtZSkge1xuICAgIGRlbGV0ZSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXVxuICB9XG5cbiAgSGVhZGVycy5wcm90b3R5cGUuZ2V0ID0gZnVuY3Rpb24obmFtZSkge1xuICAgIHZhciB2YWx1ZXMgPSB0aGlzLm1hcFtub3JtYWxpemVOYW1lKG5hbWUpXVxuICAgIHJldHVybiB2YWx1ZXMgPyB2YWx1ZXNbMF0gOiBudWxsXG4gIH1cblxuICBIZWFkZXJzLnByb3RvdHlwZS5nZXRBbGwgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMubWFwW25vcm1hbGl6ZU5hbWUobmFtZSldIHx8IFtdXG4gIH1cblxuICBIZWFkZXJzLnByb3RvdHlwZS5oYXMgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgcmV0dXJuIHRoaXMubWFwLmhhc093blByb3BlcnR5KG5vcm1hbGl6ZU5hbWUobmFtZSkpXG4gIH1cblxuICBIZWFkZXJzLnByb3RvdHlwZS5zZXQgPSBmdW5jdGlvbihuYW1lLCB2YWx1ZSkge1xuICAgIHRoaXMubWFwW25vcm1hbGl6ZU5hbWUobmFtZSldID0gW25vcm1hbGl6ZVZhbHVlKHZhbHVlKV1cbiAgfVxuXG4gIEhlYWRlcnMucHJvdG90eXBlLmZvckVhY2ggPSBmdW5jdGlvbihjYWxsYmFjaywgdGhpc0FyZykge1xuICAgIE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKHRoaXMubWFwKS5mb3JFYWNoKGZ1bmN0aW9uKG5hbWUpIHtcbiAgICAgIHRoaXMubWFwW25hbWVdLmZvckVhY2goZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgY2FsbGJhY2suY2FsbCh0aGlzQXJnLCB2YWx1ZSwgbmFtZSwgdGhpcylcbiAgICAgIH0sIHRoaXMpXG4gICAgfSwgdGhpcylcbiAgfVxuXG4gIGZ1bmN0aW9uIGNvbnN1bWVkKGJvZHkpIHtcbiAgICBpZiAoYm9keS5ib2R5VXNlZCkge1xuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KG5ldyBUeXBlRXJyb3IoJ0FscmVhZHkgcmVhZCcpKVxuICAgIH1cbiAgICBib2R5LmJvZHlVc2VkID0gdHJ1ZVxuICB9XG5cbiAgZnVuY3Rpb24gZmlsZVJlYWRlclJlYWR5KHJlYWRlcikge1xuICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzb2x2ZShyZWFkZXIucmVzdWx0KVxuICAgICAgfVxuICAgICAgcmVhZGVyLm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KHJlYWRlci5lcnJvcilcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgZnVuY3Rpb24gcmVhZEJsb2JBc0FycmF5QnVmZmVyKGJsb2IpIHtcbiAgICB2YXIgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKVxuICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihibG9iKVxuICAgIHJldHVybiBmaWxlUmVhZGVyUmVhZHkocmVhZGVyKVxuICB9XG5cbiAgZnVuY3Rpb24gcmVhZEJsb2JBc1RleHQoYmxvYikge1xuICAgIHZhciByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpXG4gICAgcmVhZGVyLnJlYWRBc1RleHQoYmxvYilcbiAgICByZXR1cm4gZmlsZVJlYWRlclJlYWR5KHJlYWRlcilcbiAgfVxuXG4gIHZhciBzdXBwb3J0ID0ge1xuICAgIGJsb2I6ICdGaWxlUmVhZGVyJyBpbiBzZWxmICYmICdCbG9iJyBpbiBzZWxmICYmIChmdW5jdGlvbigpIHtcbiAgICAgIHRyeSB7XG4gICAgICAgIG5ldyBCbG9iKCk7XG4gICAgICAgIHJldHVybiB0cnVlXG4gICAgICB9IGNhdGNoKGUpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlXG4gICAgICB9XG4gICAgfSkoKSxcbiAgICBmb3JtRGF0YTogJ0Zvcm1EYXRhJyBpbiBzZWxmLFxuICAgIGFycmF5QnVmZmVyOiAnQXJyYXlCdWZmZXInIGluIHNlbGZcbiAgfVxuXG4gIGZ1bmN0aW9uIEJvZHkoKSB7XG4gICAgdGhpcy5ib2R5VXNlZCA9IGZhbHNlXG5cblxuICAgIHRoaXMuX2luaXRCb2R5ID0gZnVuY3Rpb24oYm9keSkge1xuICAgICAgdGhpcy5fYm9keUluaXQgPSBib2R5XG4gICAgICBpZiAodHlwZW9mIGJvZHkgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gYm9keVxuICAgICAgfSBlbHNlIGlmIChzdXBwb3J0LmJsb2IgJiYgQmxvYi5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5QmxvYiA9IGJvZHlcbiAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5mb3JtRGF0YSAmJiBGb3JtRGF0YS5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICB0aGlzLl9ib2R5Rm9ybURhdGEgPSBib2R5XG4gICAgICB9IGVsc2UgaWYgKCFib2R5KSB7XG4gICAgICAgIHRoaXMuX2JvZHlUZXh0ID0gJydcbiAgICAgIH0gZWxzZSBpZiAoc3VwcG9ydC5hcnJheUJ1ZmZlciAmJiBBcnJheUJ1ZmZlci5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihib2R5KSkge1xuICAgICAgICAvLyBPbmx5IHN1cHBvcnQgQXJyYXlCdWZmZXJzIGZvciBQT1NUIG1ldGhvZC5cbiAgICAgICAgLy8gUmVjZWl2aW5nIEFycmF5QnVmZmVycyBoYXBwZW5zIHZpYSBCbG9icywgaW5zdGVhZC5cbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcigndW5zdXBwb3J0ZWQgQm9keUluaXQgdHlwZScpXG4gICAgICB9XG4gICAgfVxuXG4gICAgaWYgKHN1cHBvcnQuYmxvYikge1xuICAgICAgdGhpcy5ibG9iID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgICAgIHJldHVybiByZWplY3RlZFxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh0aGlzLl9ib2R5QmxvYilcbiAgICAgICAgfSBlbHNlIGlmICh0aGlzLl9ib2R5Rm9ybURhdGEpIHtcbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ2NvdWxkIG5vdCByZWFkIEZvcm1EYXRhIGJvZHkgYXMgYmxvYicpXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZShuZXcgQmxvYihbdGhpcy5fYm9keVRleHRdKSlcbiAgICAgICAgfVxuICAgICAgfVxuXG4gICAgICB0aGlzLmFycmF5QnVmZmVyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmJsb2IoKS50aGVuKHJlYWRCbG9iQXNBcnJheUJ1ZmZlcilcbiAgICAgIH1cblxuICAgICAgdGhpcy50ZXh0ID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciByZWplY3RlZCA9IGNvbnN1bWVkKHRoaXMpXG4gICAgICAgIGlmIChyZWplY3RlZCkge1xuICAgICAgICAgIHJldHVybiByZWplY3RlZFxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHRoaXMuX2JvZHlCbG9iKSB7XG4gICAgICAgICAgcmV0dXJuIHJlYWRCbG9iQXNUZXh0KHRoaXMuX2JvZHlCbG9iKVxuICAgICAgICB9IGVsc2UgaWYgKHRoaXMuX2JvZHlGb3JtRGF0YSkge1xuICAgICAgICAgIHRocm93IG5ldyBFcnJvcignY291bGQgbm90IHJlYWQgRm9ybURhdGEgYm9keSBhcyB0ZXh0JylcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKHRoaXMuX2JvZHlUZXh0KVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMudGV4dCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcmVqZWN0ZWQgPSBjb25zdW1lZCh0aGlzKVxuICAgICAgICByZXR1cm4gcmVqZWN0ZWQgPyByZWplY3RlZCA6IFByb21pc2UucmVzb2x2ZSh0aGlzLl9ib2R5VGV4dClcbiAgICAgIH1cbiAgICB9XG5cbiAgICBpZiAoc3VwcG9ydC5mb3JtRGF0YSkge1xuICAgICAgdGhpcy5mb3JtRGF0YSA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihkZWNvZGUpXG4gICAgICB9XG4gICAgfVxuXG4gICAgdGhpcy5qc29uID0gZnVuY3Rpb24oKSB7XG4gICAgICByZXR1cm4gdGhpcy50ZXh0KCkudGhlbihKU09OLnBhcnNlKVxuICAgIH1cblxuICAgIHJldHVybiB0aGlzXG4gIH1cblxuICAvLyBIVFRQIG1ldGhvZHMgd2hvc2UgY2FwaXRhbGl6YXRpb24gc2hvdWxkIGJlIG5vcm1hbGl6ZWRcbiAgdmFyIG1ldGhvZHMgPSBbJ0RFTEVURScsICdHRVQnLCAnSEVBRCcsICdPUFRJT05TJywgJ1BPU1QnLCAnUFVUJ11cblxuICBmdW5jdGlvbiBub3JtYWxpemVNZXRob2QobWV0aG9kKSB7XG4gICAgdmFyIHVwY2FzZWQgPSBtZXRob2QudG9VcHBlckNhc2UoKVxuICAgIHJldHVybiAobWV0aG9kcy5pbmRleE9mKHVwY2FzZWQpID4gLTEpID8gdXBjYXNlZCA6IG1ldGhvZFxuICB9XG5cbiAgZnVuY3Rpb24gUmVxdWVzdChpbnB1dCwgb3B0aW9ucykge1xuICAgIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9XG4gICAgdmFyIGJvZHkgPSBvcHRpb25zLmJvZHlcbiAgICBpZiAoUmVxdWVzdC5wcm90b3R5cGUuaXNQcm90b3R5cGVPZihpbnB1dCkpIHtcbiAgICAgIGlmIChpbnB1dC5ib2R5VXNlZCkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdBbHJlYWR5IHJlYWQnKVxuICAgICAgfVxuICAgICAgdGhpcy51cmwgPSBpbnB1dC51cmxcbiAgICAgIHRoaXMuY3JlZGVudGlhbHMgPSBpbnB1dC5jcmVkZW50aWFsc1xuICAgICAgaWYgKCFvcHRpb25zLmhlYWRlcnMpIHtcbiAgICAgICAgdGhpcy5oZWFkZXJzID0gbmV3IEhlYWRlcnMoaW5wdXQuaGVhZGVycylcbiAgICAgIH1cbiAgICAgIHRoaXMubWV0aG9kID0gaW5wdXQubWV0aG9kXG4gICAgICB0aGlzLm1vZGUgPSBpbnB1dC5tb2RlXG4gICAgICBpZiAoIWJvZHkpIHtcbiAgICAgICAgYm9keSA9IGlucHV0Ll9ib2R5SW5pdFxuICAgICAgICBpbnB1dC5ib2R5VXNlZCA9IHRydWVcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy51cmwgPSBpbnB1dFxuICAgIH1cblxuICAgIHRoaXMuY3JlZGVudGlhbHMgPSBvcHRpb25zLmNyZWRlbnRpYWxzIHx8IHRoaXMuY3JlZGVudGlhbHMgfHwgJ29taXQnXG4gICAgaWYgKG9wdGlvbnMuaGVhZGVycyB8fCAhdGhpcy5oZWFkZXJzKSB7XG4gICAgICB0aGlzLmhlYWRlcnMgPSBuZXcgSGVhZGVycyhvcHRpb25zLmhlYWRlcnMpXG4gICAgfVxuICAgIHRoaXMubWV0aG9kID0gbm9ybWFsaXplTWV0aG9kKG9wdGlvbnMubWV0aG9kIHx8IHRoaXMubWV0aG9kIHx8ICdHRVQnKVxuICAgIHRoaXMubW9kZSA9IG9wdGlvbnMubW9kZSB8fCB0aGlzLm1vZGUgfHwgbnVsbFxuICAgIHRoaXMucmVmZXJyZXIgPSBudWxsXG5cbiAgICBpZiAoKHRoaXMubWV0aG9kID09PSAnR0VUJyB8fCB0aGlzLm1ldGhvZCA9PT0gJ0hFQUQnKSAmJiBib2R5KSB7XG4gICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdCb2R5IG5vdCBhbGxvd2VkIGZvciBHRVQgb3IgSEVBRCByZXF1ZXN0cycpXG4gICAgfVxuICAgIHRoaXMuX2luaXRCb2R5KGJvZHkpXG4gIH1cblxuICBSZXF1ZXN0LnByb3RvdHlwZS5jbG9uZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgUmVxdWVzdCh0aGlzKVxuICB9XG5cbiAgZnVuY3Rpb24gZGVjb2RlKGJvZHkpIHtcbiAgICB2YXIgZm9ybSA9IG5ldyBGb3JtRGF0YSgpXG4gICAgYm9keS50cmltKCkuc3BsaXQoJyYnKS5mb3JFYWNoKGZ1bmN0aW9uKGJ5dGVzKSB7XG4gICAgICBpZiAoYnl0ZXMpIHtcbiAgICAgICAgdmFyIHNwbGl0ID0gYnl0ZXMuc3BsaXQoJz0nKVxuICAgICAgICB2YXIgbmFtZSA9IHNwbGl0LnNoaWZ0KCkucmVwbGFjZSgvXFwrL2csICcgJylcbiAgICAgICAgdmFyIHZhbHVlID0gc3BsaXQuam9pbignPScpLnJlcGxhY2UoL1xcKy9nLCAnICcpXG4gICAgICAgIGZvcm0uYXBwZW5kKGRlY29kZVVSSUNvbXBvbmVudChuYW1lKSwgZGVjb2RlVVJJQ29tcG9uZW50KHZhbHVlKSlcbiAgICAgIH1cbiAgICB9KVxuICAgIHJldHVybiBmb3JtXG4gIH1cblxuICBmdW5jdGlvbiBoZWFkZXJzKHhocikge1xuICAgIHZhciBoZWFkID0gbmV3IEhlYWRlcnMoKVxuICAgIHZhciBwYWlycyA9IHhoci5nZXRBbGxSZXNwb25zZUhlYWRlcnMoKS50cmltKCkuc3BsaXQoJ1xcbicpXG4gICAgcGFpcnMuZm9yRWFjaChmdW5jdGlvbihoZWFkZXIpIHtcbiAgICAgIHZhciBzcGxpdCA9IGhlYWRlci50cmltKCkuc3BsaXQoJzonKVxuICAgICAgdmFyIGtleSA9IHNwbGl0LnNoaWZ0KCkudHJpbSgpXG4gICAgICB2YXIgdmFsdWUgPSBzcGxpdC5qb2luKCc6JykudHJpbSgpXG4gICAgICBoZWFkLmFwcGVuZChrZXksIHZhbHVlKVxuICAgIH0pXG4gICAgcmV0dXJuIGhlYWRcbiAgfVxuXG4gIEJvZHkuY2FsbChSZXF1ZXN0LnByb3RvdHlwZSlcblxuICBmdW5jdGlvbiBSZXNwb25zZShib2R5SW5pdCwgb3B0aW9ucykge1xuICAgIGlmICghb3B0aW9ucykge1xuICAgICAgb3B0aW9ucyA9IHt9XG4gICAgfVxuXG4gICAgdGhpcy5faW5pdEJvZHkoYm9keUluaXQpXG4gICAgdGhpcy50eXBlID0gJ2RlZmF1bHQnXG4gICAgdGhpcy5zdGF0dXMgPSBvcHRpb25zLnN0YXR1c1xuICAgIHRoaXMub2sgPSB0aGlzLnN0YXR1cyA+PSAyMDAgJiYgdGhpcy5zdGF0dXMgPCAzMDBcbiAgICB0aGlzLnN0YXR1c1RleHQgPSBvcHRpb25zLnN0YXR1c1RleHRcbiAgICB0aGlzLmhlYWRlcnMgPSBvcHRpb25zLmhlYWRlcnMgaW5zdGFuY2VvZiBIZWFkZXJzID8gb3B0aW9ucy5oZWFkZXJzIDogbmV3IEhlYWRlcnMob3B0aW9ucy5oZWFkZXJzKVxuICAgIHRoaXMudXJsID0gb3B0aW9ucy51cmwgfHwgJydcbiAgfVxuXG4gIEJvZHkuY2FsbChSZXNwb25zZS5wcm90b3R5cGUpXG5cbiAgUmVzcG9uc2UucHJvdG90eXBlLmNsb25lID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBSZXNwb25zZSh0aGlzLl9ib2R5SW5pdCwge1xuICAgICAgc3RhdHVzOiB0aGlzLnN0YXR1cyxcbiAgICAgIHN0YXR1c1RleHQ6IHRoaXMuc3RhdHVzVGV4dCxcbiAgICAgIGhlYWRlcnM6IG5ldyBIZWFkZXJzKHRoaXMuaGVhZGVycyksXG4gICAgICB1cmw6IHRoaXMudXJsXG4gICAgfSlcbiAgfVxuXG4gIFJlc3BvbnNlLmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgdmFyIHJlc3BvbnNlID0gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IDAsIHN0YXR1c1RleHQ6ICcnfSlcbiAgICByZXNwb25zZS50eXBlID0gJ2Vycm9yJ1xuICAgIHJldHVybiByZXNwb25zZVxuICB9XG5cbiAgdmFyIHJlZGlyZWN0U3RhdHVzZXMgPSBbMzAxLCAzMDIsIDMwMywgMzA3LCAzMDhdXG5cbiAgUmVzcG9uc2UucmVkaXJlY3QgPSBmdW5jdGlvbih1cmwsIHN0YXR1cykge1xuICAgIGlmIChyZWRpcmVjdFN0YXR1c2VzLmluZGV4T2Yoc3RhdHVzKSA9PT0gLTEpIHtcbiAgICAgIHRocm93IG5ldyBSYW5nZUVycm9yKCdJbnZhbGlkIHN0YXR1cyBjb2RlJylcbiAgICB9XG5cbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKG51bGwsIHtzdGF0dXM6IHN0YXR1cywgaGVhZGVyczoge2xvY2F0aW9uOiB1cmx9fSlcbiAgfVxuXG4gIHNlbGYuSGVhZGVycyA9IEhlYWRlcnM7XG4gIHNlbGYuUmVxdWVzdCA9IFJlcXVlc3Q7XG4gIHNlbGYuUmVzcG9uc2UgPSBSZXNwb25zZTtcblxuICBzZWxmLmZldGNoID0gZnVuY3Rpb24oaW5wdXQsIGluaXQpIHtcbiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICB2YXIgcmVxdWVzdFxuICAgICAgaWYgKFJlcXVlc3QucHJvdG90eXBlLmlzUHJvdG90eXBlT2YoaW5wdXQpICYmICFpbml0KSB7XG4gICAgICAgIHJlcXVlc3QgPSBpbnB1dFxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVxdWVzdCA9IG5ldyBSZXF1ZXN0KGlucHV0LCBpbml0KVxuICAgICAgfVxuXG4gICAgICB2YXIgeGhyID0gbmV3IFhNTEh0dHBSZXF1ZXN0KClcblxuICAgICAgZnVuY3Rpb24gcmVzcG9uc2VVUkwoKSB7XG4gICAgICAgIGlmICgncmVzcG9uc2VVUkwnIGluIHhocikge1xuICAgICAgICAgIHJldHVybiB4aHIucmVzcG9uc2VVUkxcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEF2b2lkIHNlY3VyaXR5IHdhcm5pbmdzIG9uIGdldFJlc3BvbnNlSGVhZGVyIHdoZW4gbm90IGFsbG93ZWQgYnkgQ09SU1xuICAgICAgICBpZiAoL15YLVJlcXVlc3QtVVJMOi9tLnRlc3QoeGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpKSkge1xuICAgICAgICAgIHJldHVybiB4aHIuZ2V0UmVzcG9uc2VIZWFkZXIoJ1gtUmVxdWVzdC1VUkwnKVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuXG4gICAgICB4aHIub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzdGF0dXMgPSAoeGhyLnN0YXR1cyA9PT0gMTIyMykgPyAyMDQgOiB4aHIuc3RhdHVzXG4gICAgICAgIGlmIChzdGF0dXMgPCAxMDAgfHwgc3RhdHVzID4gNTk5KSB7XG4gICAgICAgICAgcmVqZWN0KG5ldyBUeXBlRXJyb3IoJ05ldHdvcmsgcmVxdWVzdCBmYWlsZWQnKSlcbiAgICAgICAgICByZXR1cm5cbiAgICAgICAgfVxuICAgICAgICB2YXIgb3B0aW9ucyA9IHtcbiAgICAgICAgICBzdGF0dXM6IHN0YXR1cyxcbiAgICAgICAgICBzdGF0dXNUZXh0OiB4aHIuc3RhdHVzVGV4dCxcbiAgICAgICAgICBoZWFkZXJzOiBoZWFkZXJzKHhociksXG4gICAgICAgICAgdXJsOiByZXNwb25zZVVSTCgpXG4gICAgICAgIH1cbiAgICAgICAgdmFyIGJvZHkgPSAncmVzcG9uc2UnIGluIHhociA/IHhoci5yZXNwb25zZSA6IHhoci5yZXNwb25zZVRleHQ7XG4gICAgICAgIHJlc29sdmUobmV3IFJlc3BvbnNlKGJvZHksIG9wdGlvbnMpKVxuICAgICAgfVxuXG4gICAgICB4aHIub25lcnJvciA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QobmV3IFR5cGVFcnJvcignTmV0d29yayByZXF1ZXN0IGZhaWxlZCcpKVxuICAgICAgfVxuXG4gICAgICB4aHIub3BlbihyZXF1ZXN0Lm1ldGhvZCwgcmVxdWVzdC51cmwsIHRydWUpXG5cbiAgICAgIGlmIChyZXF1ZXN0LmNyZWRlbnRpYWxzID09PSAnaW5jbHVkZScpIHtcbiAgICAgICAgeGhyLndpdGhDcmVkZW50aWFscyA9IHRydWVcbiAgICAgIH1cblxuICAgICAgaWYgKCdyZXNwb25zZVR5cGUnIGluIHhociAmJiBzdXBwb3J0LmJsb2IpIHtcbiAgICAgICAgeGhyLnJlc3BvbnNlVHlwZSA9ICdibG9iJ1xuICAgICAgfVxuXG4gICAgICByZXF1ZXN0LmhlYWRlcnMuZm9yRWFjaChmdW5jdGlvbih2YWx1ZSwgbmFtZSkge1xuICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcihuYW1lLCB2YWx1ZSlcbiAgICAgIH0pXG5cbiAgICAgIHhoci5zZW5kKHR5cGVvZiByZXF1ZXN0Ll9ib2R5SW5pdCA9PT0gJ3VuZGVmaW5lZCcgPyBudWxsIDogcmVxdWVzdC5fYm9keUluaXQpXG4gICAgfSlcbiAgfVxuXG4gIHNlbGYuZmV0Y2gucG9seWZpbGwgPSB0cnVlXG59XG5cbm1vZHVsZS5leHBvcnRzID0gc2VsZi5mZXRjaDtcbiJdfQ==