







'use strict';var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};

var _react=require('react');var _react2=_interopRequireDefault(_react);
var _ReactView=require('../View/View.web');var _ReactView2=_interopRequireDefault(_ReactView);
var _reactTimerMixin=require('react-timer-mixin');var _reactTimerMixin2=_interopRequireDefault(_reactTimerMixin);
var _ReactTouchableWithoutFeedback=require('./TouchableWithoutFeedback.web');var _ReactTouchableWithoutFeedback2=_interopRequireDefault(_ReactTouchableWithoutFeedback);
var _ReactTouchable=require('./Touchable');
var _NativeMethodsMixin=require('../Utilties/NativeMethodsMixin.web');
var _ReactStyleSheet=require('../StyleSheet/StyleSheet.web');var _ReactStyleSheet2=_interopRequireDefault(_ReactStyleSheet);
var _reactMixin=require('react-mixin');var _reactMixin2=_interopRequireDefault(_reactMixin);
var _autobindDecorator=require('autobind-decorator');var _autobindDecorator2=_interopRequireDefault(_autobindDecorator);
var _ReactFlattenStyle=require('../StyleSheet/flattenStyle.web');var _ReactFlattenStyle2=_interopRequireDefault(_ReactFlattenStyle);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}



var DEFAULT_PROPS={
activeOpacity:0.8,
underlayColor:'black',
style:_ReactStyleSheet2.default.create({
cursor:'pointer'})};



var PRESS_RECT_OFFSET={top:20,left:20,right:20,bottom:30};
var CHILD_REF='childRef';
var UNDERLAY_REF='underlayRef';
var INACTIVE_CHILD_PROPS={
style:_ReactStyleSheet2.default.create({x:{opacity:1.0}}).x};

var INACTIVE_UNDERLAY_PROPS={
style:_ReactStyleSheet2.default.create({x:{backgroundColor:'transparent'}}).x};


var DEFAULT_UNDERLAY_STYLE=_extends({},
DEFAULT_PROPS.style,
INACTIVE_UNDERLAY_PROPS.style);var


TouchableHighlight=function(_Component){_inherits(TouchableHighlight,_Component);function TouchableHighlight(){var _ref;var _temp,_this,_ret;_classCallCheck(this,TouchableHighlight);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=TouchableHighlight.__proto__||Object.getPrototypeOf(TouchableHighlight)).call.apply(_ref,[this].concat(args))),_this),_this.
























state=_extends({},_this.touchableGetInitialState(),_this.computeSyntheticState(_this.props)),_temp),_possibleConstructorReturn(_this,_ret);}_createClass(TouchableHighlight,[{key:'computeSyntheticState',value:function computeSyntheticState(


props){
return{
activeProps:{
style:{
opacity:props.activeOpacity}},


activeUnderlayProps:{
style:{
backgroundColor:props.underlayColor}},


underlayStyle:(0,_ReactFlattenStyle2.default)([
DEFAULT_UNDERLAY_STYLE,
props.style])};


}},{key:'componentDidUpdate',value:function componentDidUpdate()






{

}},{key:'componentWillReceiveProps',value:function componentWillReceiveProps(

nextProps){

if(nextProps.activeOpacity!==this.props.activeOpacity||
nextProps.underlayColor!==this.props.underlayColor||
nextProps.style!==this.props.style){
this.setState(this.computeSyntheticState(nextProps));
}
}},{key:'touchableHandleActivePressIn',value:function touchableHandleActivePressIn(





e){
this.clearTimeout(this._hideTimeout);
this._hideTimeout=null;
this._showUnderlay();
this.props.onPressIn&&this.props.onPressIn(e);
}},{key:'touchableHandleActivePressOut',value:function touchableHandleActivePressOut(

e){
if(!this._hideTimeout){
this._hideUnderlay();
}
this.props.onPressOut&&this.props.onPressOut(e);
}},{key:'touchableHandlePress',value:function touchableHandlePress(

e){
this.clearTimeout(this._hideTimeout);
this._showUnderlay();
this._hideTimeout=this.setTimeout(this._hideUnderlay,
this.props.delayPressOut||100);

var touchBank=e.touchHistory.touchBank[e.touchHistory.indexOfSingleActiveTouch];
if(touchBank){
var offset=Math.sqrt(Math.pow(touchBank.startPageX-touchBank.currentPageX,2)+
Math.pow(touchBank.startPageY-touchBank.currentPageY,2));
var velocity=offset/(touchBank.currentTimeStamp-touchBank.startTimeStamp)*1000;
if(velocity<100)this.props.onPress&&this.props.onPress(e);
}else{
this.props.onPress&&this.props.onPress(e);
}
}},{key:'touchableHandleLongPress',value:function touchableHandleLongPress(

e){
this.props.onLongPress&&this.props.onLongPress(e);
}},{key:'touchableGetPressRectOffset',value:function touchableGetPressRectOffset()

{
return PRESS_RECT_OFFSET;
}},{key:'touchableGetHighlightDelayMS',value:function touchableGetHighlightDelayMS()

{
return this.props.delayPressIn;
}},{key:'touchableGetLongPressDelayMS',value:function touchableGetLongPressDelayMS()

{
return this.props.delayLongPress;
}},{key:'touchableGetPressOutDelayMS',value:function touchableGetPressOutDelayMS()

{
return this.props.delayPressOut;
}},{key:'_showUnderlay',value:function _showUnderlay()

{




this.refs[UNDERLAY_REF].setNativeProps(this.state.activeUnderlayProps);
this.refs[CHILD_REF].setNativeProps(this.state.activeProps);
this.props.onShowUnderlay&&this.props.onShowUnderlay();
}},{key:'_hideUnderlay',value:function _hideUnderlay()

{
this.clearTimeout(this._hideTimeout);
this._hideTimeout=null;
if(this.refs[UNDERLAY_REF]){
this.refs[CHILD_REF].setNativeProps(INACTIVE_CHILD_PROPS);
this.refs[UNDERLAY_REF].setNativeProps(_extends({},
INACTIVE_UNDERLAY_PROPS,{
style:this.state.underlayStyle}));

this.props.onHideUnderlay&&this.props.onHideUnderlay();
}
}},{key:'render',value:function render()

{

return(
_react2.default.createElement(_ReactView2.default,{
accessible:true,
accessibilityComponentType:this.props.accessibilityComponentType,
accessibilityTraits:this.props.accessibilityTraits,
ref:UNDERLAY_REF,
style:this.state.underlayStyle,
onLayout:this.props.onLayout,
onStartShouldSetResponder:this.touchableHandleStartShouldSetResponder,
onResponderTerminationRequest:this.touchableHandleResponderTerminationRequest,
onResponderGrant:this.touchableHandleResponderGrant,
onResponderMove:this.touchableHandleResponderMove,
onResponderRelease:this.touchableHandleResponderRelease,
onResponderTerminate:this.touchableHandleResponderTerminate,
testID:this.props.testID},
_react2.default.cloneElement(
_react2.default.Children.only(this.props.children),
{
ref:CHILD_REF})));




}}]);return TouchableHighlight;}(_react.Component);TouchableHighlight.propTypes=_extends({},_ReactTouchableWithoutFeedback2.default.propTypes,{activeOpacity:_react2.default.PropTypes.number,underlayColor:_react2.default.PropTypes.string,onShowUnderlay:_react2.default.PropTypes.func,onHideUnderlay:_react2.default.PropTypes.func});TouchableHighlight.defaultProps=DEFAULT_PROPS;

;

_reactMixin2.default.onClass(TouchableHighlight,_reactTimerMixin2.default);
_reactMixin2.default.onClass(TouchableHighlight,_ReactTouchable.Mixin);
_reactMixin2.default.onClass(TouchableHighlight,_NativeMethodsMixin.Mixin);
(0,_autobindDecorator2.default)(TouchableHighlight);

module.exports=TouchableHighlight;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRvdWNoYWJsZUhpZ2hsaWdodC53ZWIuanMiXSwibmFtZXMiOlsiREVGQVVMVF9QUk9QUyIsImFjdGl2ZU9wYWNpdHkiLCJ1bmRlcmxheUNvbG9yIiwic3R5bGUiLCJjcmVhdGUiLCJjdXJzb3IiLCJQUkVTU19SRUNUX09GRlNFVCIsInRvcCIsImxlZnQiLCJyaWdodCIsImJvdHRvbSIsIkNISUxEX1JFRiIsIlVOREVSTEFZX1JFRiIsIklOQUNUSVZFX0NISUxEX1BST1BTIiwieCIsIm9wYWNpdHkiLCJJTkFDVElWRV9VTkRFUkxBWV9QUk9QUyIsImJhY2tncm91bmRDb2xvciIsIkRFRkFVTFRfVU5ERVJMQVlfU1RZTEUiLCJUb3VjaGFibGVIaWdobGlnaHQiLCJzdGF0ZSIsInRvdWNoYWJsZUdldEluaXRpYWxTdGF0ZSIsImNvbXB1dGVTeW50aGV0aWNTdGF0ZSIsInByb3BzIiwiYWN0aXZlUHJvcHMiLCJhY3RpdmVVbmRlcmxheVByb3BzIiwidW5kZXJsYXlTdHlsZSIsIm5leHRQcm9wcyIsInNldFN0YXRlIiwiZSIsImNsZWFyVGltZW91dCIsIl9oaWRlVGltZW91dCIsIl9zaG93VW5kZXJsYXkiLCJvblByZXNzSW4iLCJfaGlkZVVuZGVybGF5Iiwib25QcmVzc091dCIsInNldFRpbWVvdXQiLCJkZWxheVByZXNzT3V0IiwidG91Y2hCYW5rIiwidG91Y2hIaXN0b3J5IiwiaW5kZXhPZlNpbmdsZUFjdGl2ZVRvdWNoIiwib2Zmc2V0IiwiTWF0aCIsInNxcnQiLCJwb3ciLCJzdGFydFBhZ2VYIiwiY3VycmVudFBhZ2VYIiwic3RhcnRQYWdlWSIsImN1cnJlbnRQYWdlWSIsInZlbG9jaXR5IiwiY3VycmVudFRpbWVTdGFtcCIsInN0YXJ0VGltZVN0YW1wIiwib25QcmVzcyIsIm9uTG9uZ1ByZXNzIiwiZGVsYXlQcmVzc0luIiwiZGVsYXlMb25nUHJlc3MiLCJyZWZzIiwic2V0TmF0aXZlUHJvcHMiLCJvblNob3dVbmRlcmxheSIsIm9uSGlkZVVuZGVybGF5IiwiYWNjZXNzaWJpbGl0eUNvbXBvbmVudFR5cGUiLCJhY2Nlc3NpYmlsaXR5VHJhaXRzIiwib25MYXlvdXQiLCJ0b3VjaGFibGVIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlciIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlckdyYW50IiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyTW92ZSIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclJlbGVhc2UiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGUiLCJ0ZXN0SUQiLCJjbG9uZUVsZW1lbnQiLCJDaGlsZHJlbiIsIm9ubHkiLCJjaGlsZHJlbiIsInJlZiIsInByb3BUeXBlcyIsIlByb3BUeXBlcyIsIm51bWJlciIsInN0cmluZyIsImZ1bmMiLCJkZWZhdWx0UHJvcHMiLCJvbkNsYXNzIiwibW9kdWxlIiwiZXhwb3J0cyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFRQSxhOztBQUVBLDRCO0FBQ0EsMkM7QUFDQSxrRDtBQUNBLDZFO0FBQ0E7QUFDQTtBQUNBLDZEO0FBQ0EsdUM7QUFDQSxxRDtBQUNBLGlFOzs7O0FBSUEsR0FBSUEsZUFBZ0I7QUFDbEJDLGNBQWUsR0FERztBQUVsQkMsY0FBZSxPQUZHO0FBR2xCQyxNQUFPLDBCQUFXQyxNQUFYLENBQWtCO0FBQ3ZCQyxPQUFRLFNBRGUsQ0FBbEIsQ0FIVyxDQUFwQjs7OztBQVFBLEdBQUlDLG1CQUFvQixDQUFDQyxJQUFLLEVBQU4sQ0FBVUMsS0FBTSxFQUFoQixDQUFvQkMsTUFBTyxFQUEzQixDQUErQkMsT0FBUSxFQUF2QyxDQUF4QjtBQUNBLEdBQUlDLFdBQVksVUFBaEI7QUFDQSxHQUFJQyxjQUFlLGFBQW5CO0FBQ0EsR0FBSUMsc0JBQXVCO0FBQ3pCVixNQUFPLDBCQUFXQyxNQUFYLENBQWtCLENBQUNVLEVBQUcsQ0FBQ0MsUUFBUyxHQUFWLENBQUosQ0FBbEIsRUFBdUNELENBRHJCLENBQTNC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S3BDLEtBQUwsQ0FBV3FDLDBCQUZ6QztBQUdFLG9CQUFxQixLQUFLckMsS0FBTCxDQUFXc0MsbUJBSGxDO0FBSUUsSUFBS2pELFlBSlA7QUFLRSxNQUFPLEtBQUtRLEtBQUwsQ0FBV00sYUFMcEI7QUFNRSxTQUFVLEtBQUtILEtBQUwsQ0FBV3VDLFFBTnZCO0FBT0UsMEJBQTJCLEtBQUtDLHNDQVBsQztBQVFFLDhCQUErQixLQUFLQywwQ0FSdEM7QUFTRSxpQkFBa0IsS0FBS0MsNkJBVHpCO0FBVUUsZ0JBQWlCLEtBQUtDLDRCQVZ4QjtBQVdFLG1CQUFvQixLQUFLQywrQkFYM0I7QUFZRSxxQkFBc0IsS0FBS0MsaUNBWjdCO0FBYUUsT0FBUSxLQUFLN0MsS0FBTCxDQUFXOEMsTUFickI7QUFjRyxnQkFBTUMsWUFBTjtBQUNDLGdCQUFNQyxRQUFOLENBQWVDLElBQWYsQ0FBb0IsS0FBS2pELEtBQUwsQ0FBV2tELFFBQS9CLENBREQ7QUFFQztBQUNFQyxJQUFLL0QsU0FEUCxDQUZELENBZEgsQ0FERjs7Ozs7QUF1QkQsQyxrREF4S0dRLGtCLENBQ0d3RCxTLGFBQ0Ysd0NBQXlCQSxTLEVBSzVCMUUsY0FBZSxnQkFBTTJFLFNBQU4sQ0FBZ0JDLE0sQ0FLL0IzRSxjQUFlLGdCQUFNMEUsU0FBTixDQUFnQkUsTSxDQUkvQnBCLGVBQWdCLGdCQUFNa0IsU0FBTixDQUFnQkcsSSxDQUloQ3BCLGVBQWdCLGdCQUFNaUIsU0FBTixDQUFnQkcsSSxHQXBCOUI1RCxrQixDQXVCRzZELFksQ0FBZWhGLGE7O0FBbUp2Qjs7QUFFRCxxQkFBTWlGLE9BQU4sQ0FBYzlELGtCQUFkO0FBQ0EscUJBQU04RCxPQUFOLENBQWM5RCxrQkFBZDtBQUNBLHFCQUFNOEQsT0FBTixDQUFjOUQsa0JBQWQ7QUFDQSxnQ0FBU0Esa0JBQVQ7O0FBRUErRCxPQUFPQyxPQUFQLENBQWlCaEUsa0JBQWpCIiwiZmlsZSI6IlRvdWNoYWJsZUhpZ2hsaWdodC53ZWIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBBbGliYWJhIEdyb3VwIEhvbGRpbmcgTGltaXRlZC5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LCBGYWNlYm9vaywgSW5jLiAgQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBAcHJvdmlkZXNNb2R1bGUgUmVhY3RUb3VjaGFibGVIaWdobGlnaHRcbiAqL1xuJ3VzZSBzdHJpY3QnO1xuXG5pbXBvcnQgUmVhY3QsIHsgQ29tcG9uZW50IH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFZpZXcgZnJvbSAnUmVhY3RWaWV3JztcbmltcG9ydCBUaW1lck1peGluIGZyb20gJ3JlYWN0LXRpbWVyLW1peGluJztcbmltcG9ydCBUb3VjaGFibGVXaXRob3V0RmVlZGJhY2sgZnJvbSAnUmVhY3RUb3VjaGFibGVXaXRob3V0RmVlZGJhY2snO1xuaW1wb3J0IHsgTWl4aW4gYXMgVG91Y2hhYmxlTWl4aW4gfSBmcm9tICdSZWFjdFRvdWNoYWJsZSc7XG5pbXBvcnQgeyBNaXhpbiBhcyBOYXRpdmVNZXRob2RzTWl4aW4gfSBmcm9tICdOYXRpdmVNZXRob2RzTWl4aW4nO1xuaW1wb3J0IFN0eWxlU2hlZXQgZnJvbSAnUmVhY3RTdHlsZVNoZWV0JztcbmltcG9ydCBtaXhpbiBmcm9tICdyZWFjdC1taXhpbic7XG5pbXBvcnQgYXV0b2JpbmQgZnJvbSAnYXV0b2JpbmQtZGVjb3JhdG9yJztcbmltcG9ydCBmbGF0dGVuU3R5bGUgZnJvbSAnUmVhY3RGbGF0dGVuU3R5bGUnO1xuXG50eXBlIEV2ZW50ID0gT2JqZWN0O1xuXG52YXIgREVGQVVMVF9QUk9QUyA9IHtcbiAgYWN0aXZlT3BhY2l0eTogMC44LFxuICB1bmRlcmxheUNvbG9yOiAnYmxhY2snLFxuICBzdHlsZTogU3R5bGVTaGVldC5jcmVhdGUoe1xuICAgIGN1cnNvcjogJ3BvaW50ZXInXG4gIH0pXG59O1xuXG52YXIgUFJFU1NfUkVDVF9PRkZTRVQgPSB7dG9wOiAyMCwgbGVmdDogMjAsIHJpZ2h0OiAyMCwgYm90dG9tOiAzMH07XG52YXIgQ0hJTERfUkVGID0gJ2NoaWxkUmVmJztcbnZhciBVTkRFUkxBWV9SRUYgPSAndW5kZXJsYXlSZWYnO1xudmFyIElOQUNUSVZFX0NISUxEX1BST1BTID0ge1xuICBzdHlsZTogU3R5bGVTaGVldC5jcmVhdGUoe3g6IHtvcGFjaXR5OiAxLjB9fSkueCxcbn07XG52YXIgSU5BQ1RJVkVfVU5ERVJMQVlfUFJPUFMgPSB7XG4gIHN0eWxlOiBTdHlsZVNoZWV0LmNyZWF0ZSh7eDoge2JhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50J319KS54LFxufTtcblxudmFyIERFRkFVTFRfVU5ERVJMQVlfU1RZTEUgPSB7XG4gIC4uLkRFRkFVTFRfUFJPUFMuc3R5bGUsXG4gIC4uLklOQUNUSVZFX1VOREVSTEFZX1BST1BTLnN0eWxlXG59XG5cbmNsYXNzIFRvdWNoYWJsZUhpZ2hsaWdodCBleHRlbmRzIENvbXBvbmVudCB7XG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgLi4uVG91Y2hhYmxlV2l0aG91dEZlZWRiYWNrLnByb3BUeXBlcyxcbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIHdoYXQgdGhlIG9wYWNpdHkgb2YgdGhlIHdyYXBwZWQgdmlldyBzaG91bGQgYmUgd2hlbiB0b3VjaCBpc1xuICAgICAqIGFjdGl2ZS5cbiAgICAgKi9cbiAgICBhY3RpdmVPcGFjaXR5OiBSZWFjdC5Qcm9wVHlwZXMubnVtYmVyLFxuICAgIC8qKlxuICAgICAqIFRoZSBjb2xvciBvZiB0aGUgdW5kZXJsYXkgdGhhdCB3aWxsIHNob3cgdGhyb3VnaCB3aGVuIHRoZSB0b3VjaCBpc1xuICAgICAqIGFjdGl2ZS5cbiAgICAgKi9cbiAgICB1bmRlcmxheUNvbG9yOiBSZWFjdC5Qcm9wVHlwZXMuc3RyaW5nLFxuICAgIC8qKlxuICAgICAqIENhbGxlZCBpbW1lZGlhdGVseSBhZnRlciB0aGUgdW5kZXJsYXkgaXMgc2hvd25cbiAgICAgKi9cbiAgICBvblNob3dVbmRlcmxheTogUmVhY3QuUHJvcFR5cGVzLmZ1bmMsXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGltbWVkaWF0ZWx5IGFmdGVyIHRoZSB1bmRlcmxheSBpcyBoaWRkZW5cbiAgICAgKi9cbiAgICBvbkhpZGVVbmRlcmxheTogUmVhY3QuUHJvcFR5cGVzLmZ1bmMsXG4gIH1cblxuICBzdGF0aWMgZGVmYXVsdFByb3BzID0gREVGQVVMVF9QUk9QU1xuXG4gIHN0YXRlID0gey4uLnRoaXMudG91Y2hhYmxlR2V0SW5pdGlhbFN0YXRlKCksIC4uLnRoaXMuY29tcHV0ZVN5bnRoZXRpY1N0YXRlKHRoaXMucHJvcHMpfVxuXG4gIC8vIFBlcmZvcm1hbmNlIG9wdGltaXphdGlvbiB0byBhdm9pZCBjb25zdGFudGx5IHJlLWdlbmVyYXRpbmcgdGhlc2Ugb2JqZWN0cy5cbiAgY29tcHV0ZVN5bnRoZXRpY1N0YXRlKHByb3BzKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFjdGl2ZVByb3BzOiB7XG4gICAgICAgIHN0eWxlOiB7XG4gICAgICAgICAgb3BhY2l0eTogcHJvcHMuYWN0aXZlT3BhY2l0eSxcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGFjdGl2ZVVuZGVybGF5UHJvcHM6IHtcbiAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICBiYWNrZ3JvdW5kQ29sb3I6IHByb3BzLnVuZGVybGF5Q29sb3IsXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICB1bmRlcmxheVN0eWxlOiBmbGF0dGVuU3R5bGUoW1xuICAgICAgICBERUZBVUxUX1VOREVSTEFZX1NUWUxFLFxuICAgICAgICBwcm9wcy5zdHlsZVxuICAgICAgXSlcbiAgICB9O1xuICB9XG5cbiAgLy8gY29tcG9uZW50RGlkTW91bnQoKSB7XG4gIC8vICAgLy8gZW5zdXJlUG9zaXRpdmVEZWxheVByb3BzKHRoaXMucHJvcHMpO1xuICAvLyAgIC8vIGVuc3VyZUNvbXBvbmVudElzTmF0aXZlKHRoaXMucmVmc1tDSElMRF9SRUZdKTtcbiAgLy8gfSxcblxuICBjb21wb25lbnREaWRVcGRhdGUoKSB7XG4gICAgLy8gZW5zdXJlQ29tcG9uZW50SXNOYXRpdmUodGhpcy5yZWZzW0NISUxEX1JFRl0pO1xuICB9XG5cbiAgY29tcG9uZW50V2lsbFJlY2VpdmVQcm9wcyhuZXh0UHJvcHMpIHtcbiAgICAvLyBlbnN1cmVQb3NpdGl2ZURlbGF5UHJvcHMobmV4dFByb3BzKTtcbiAgICBpZiAobmV4dFByb3BzLmFjdGl2ZU9wYWNpdHkgIT09IHRoaXMucHJvcHMuYWN0aXZlT3BhY2l0eSB8fFxuICAgICAgICBuZXh0UHJvcHMudW5kZXJsYXlDb2xvciAhPT0gdGhpcy5wcm9wcy51bmRlcmxheUNvbG9yIHx8XG4gICAgICAgIG5leHRQcm9wcy5zdHlsZSAhPT0gdGhpcy5wcm9wcy5zdHlsZSkge1xuICAgICAgdGhpcy5zZXRTdGF0ZSh0aGlzLmNvbXB1dGVTeW50aGV0aWNTdGF0ZShuZXh0UHJvcHMpKTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogYFRvdWNoYWJsZS5NaXhpbmAgc2VsZiBjYWxsYmFja3MuIFRoZSBtaXhpbiB3aWxsIGludm9rZSB0aGVzZSBpZiB0aGV5IGFyZVxuICAgKiBkZWZpbmVkIG9uIHlvdXIgY29tcG9uZW50LlxuICAgKi9cbiAgdG91Y2hhYmxlSGFuZGxlQWN0aXZlUHJlc3NJbihlOiBFdmVudCkge1xuICAgIHRoaXMuY2xlYXJUaW1lb3V0KHRoaXMuX2hpZGVUaW1lb3V0KTtcbiAgICB0aGlzLl9oaWRlVGltZW91dCA9IG51bGw7XG4gICAgdGhpcy5fc2hvd1VuZGVybGF5KCk7XG4gICAgdGhpcy5wcm9wcy5vblByZXNzSW4gJiYgdGhpcy5wcm9wcy5vblByZXNzSW4oZSk7XG4gIH1cblxuICB0b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc091dChlOiBFdmVudCkge1xuICAgIGlmICghdGhpcy5faGlkZVRpbWVvdXQpIHtcbiAgICAgIHRoaXMuX2hpZGVVbmRlcmxheSgpO1xuICAgIH1cbiAgICB0aGlzLnByb3BzLm9uUHJlc3NPdXQgJiYgdGhpcy5wcm9wcy5vblByZXNzT3V0KGUpO1xuICB9XG5cbiAgdG91Y2hhYmxlSGFuZGxlUHJlc3MoZTogRXZlbnQpIHtcbiAgICB0aGlzLmNsZWFyVGltZW91dCh0aGlzLl9oaWRlVGltZW91dCk7XG4gICAgdGhpcy5fc2hvd1VuZGVybGF5KCk7XG4gICAgdGhpcy5faGlkZVRpbWVvdXQgPSB0aGlzLnNldFRpbWVvdXQodGhpcy5faGlkZVVuZGVybGF5LFxuICAgICAgdGhpcy5wcm9wcy5kZWxheVByZXNzT3V0IHx8IDEwMCk7XG5cbiAgICB2YXIgdG91Y2hCYW5rID0gZS50b3VjaEhpc3RvcnkudG91Y2hCYW5rW2UudG91Y2hIaXN0b3J5LmluZGV4T2ZTaW5nbGVBY3RpdmVUb3VjaF07XG4gICAgaWYgKHRvdWNoQmFuaykge1xuICAgICAgdmFyIG9mZnNldCA9IE1hdGguc3FydChNYXRoLnBvdyh0b3VjaEJhbmsuc3RhcnRQYWdlWCAtIHRvdWNoQmFuay5jdXJyZW50UGFnZVgsIDIpXG4gICAgICAgICAgKyBNYXRoLnBvdyh0b3VjaEJhbmsuc3RhcnRQYWdlWSAtIHRvdWNoQmFuay5jdXJyZW50UGFnZVksIDIpKTtcbiAgICAgIHZhciB2ZWxvY2l0eSA9IChvZmZzZXQgLyAodG91Y2hCYW5rLmN1cnJlbnRUaW1lU3RhbXAgLSB0b3VjaEJhbmsuc3RhcnRUaW1lU3RhbXApKSAqIDEwMDA7XG4gICAgICBpZiAodmVsb2NpdHkgPCAxMDApIHRoaXMucHJvcHMub25QcmVzcyAmJiB0aGlzLnByb3BzLm9uUHJlc3MoZSk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMucHJvcHMub25QcmVzcyAmJiB0aGlzLnByb3BzLm9uUHJlc3MoZSk7XG4gICAgfVxuICB9XG5cbiAgdG91Y2hhYmxlSGFuZGxlTG9uZ1ByZXNzKGU6IEV2ZW50KSB7XG4gICAgdGhpcy5wcm9wcy5vbkxvbmdQcmVzcyAmJiB0aGlzLnByb3BzLm9uTG9uZ1ByZXNzKGUpO1xuICB9XG5cbiAgdG91Y2hhYmxlR2V0UHJlc3NSZWN0T2Zmc2V0KCkge1xuICAgIHJldHVybiBQUkVTU19SRUNUX09GRlNFVDsgICAvLyBBbHdheXMgbWFrZSBzdXJlIHRvIHByZWRlY2xhcmUgYSBjb25zdGFudCFcbiAgfVxuXG4gIHRvdWNoYWJsZUdldEhpZ2hsaWdodERlbGF5TVMoKSB7XG4gICAgcmV0dXJuIHRoaXMucHJvcHMuZGVsYXlQcmVzc0luO1xuICB9XG5cbiAgdG91Y2hhYmxlR2V0TG9uZ1ByZXNzRGVsYXlNUygpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5kZWxheUxvbmdQcmVzcztcbiAgfVxuXG4gIHRvdWNoYWJsZUdldFByZXNzT3V0RGVsYXlNUygpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5kZWxheVByZXNzT3V0O1xuICB9XG5cbiAgX3Nob3dVbmRlcmxheSgpIHtcbiAgICAvLyBpZiAoIXRoaXMuaXNNb3VudGVkKCkpIHtcbiAgICAvLyAgIHJldHVybjtcbiAgICAvLyB9XG5cbiAgICB0aGlzLnJlZnNbVU5ERVJMQVlfUkVGXS5zZXROYXRpdmVQcm9wcyh0aGlzLnN0YXRlLmFjdGl2ZVVuZGVybGF5UHJvcHMpO1xuICAgIHRoaXMucmVmc1tDSElMRF9SRUZdLnNldE5hdGl2ZVByb3BzKHRoaXMuc3RhdGUuYWN0aXZlUHJvcHMpO1xuICAgIHRoaXMucHJvcHMub25TaG93VW5kZXJsYXkgJiYgdGhpcy5wcm9wcy5vblNob3dVbmRlcmxheSgpO1xuICB9XG5cbiAgX2hpZGVVbmRlcmxheSgpIHtcbiAgICB0aGlzLmNsZWFyVGltZW91dCh0aGlzLl9oaWRlVGltZW91dCk7XG4gICAgdGhpcy5faGlkZVRpbWVvdXQgPSBudWxsO1xuICAgIGlmICh0aGlzLnJlZnNbVU5ERVJMQVlfUkVGXSkge1xuICAgICAgdGhpcy5yZWZzW0NISUxEX1JFRl0uc2V0TmF0aXZlUHJvcHMoSU5BQ1RJVkVfQ0hJTERfUFJPUFMpO1xuICAgICAgdGhpcy5yZWZzW1VOREVSTEFZX1JFRl0uc2V0TmF0aXZlUHJvcHMoe1xuICAgICAgICAuLi5JTkFDVElWRV9VTkRFUkxBWV9QUk9QUyxcbiAgICAgICAgc3R5bGU6IHRoaXMuc3RhdGUudW5kZXJsYXlTdHlsZSxcbiAgICAgIH0pO1xuICAgICAgdGhpcy5wcm9wcy5vbkhpZGVVbmRlcmxheSAmJiB0aGlzLnByb3BzLm9uSGlkZVVuZGVybGF5KCk7XG4gICAgfVxuICB9XG5cbiAgcmVuZGVyKCkge1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxWaWV3XG4gICAgICAgIGFjY2Vzc2libGU9e3RydWV9XG4gICAgICAgIGFjY2Vzc2liaWxpdHlDb21wb25lbnRUeXBlPXt0aGlzLnByb3BzLmFjY2Vzc2liaWxpdHlDb21wb25lbnRUeXBlfVxuICAgICAgICBhY2Nlc3NpYmlsaXR5VHJhaXRzPXt0aGlzLnByb3BzLmFjY2Vzc2liaWxpdHlUcmFpdHN9XG4gICAgICAgIHJlZj17VU5ERVJMQVlfUkVGfVxuICAgICAgICBzdHlsZT17dGhpcy5zdGF0ZS51bmRlcmxheVN0eWxlfVxuICAgICAgICBvbkxheW91dD17dGhpcy5wcm9wcy5vbkxheW91dH1cbiAgICAgICAgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcj17dGhpcy50b3VjaGFibGVIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlcn1cbiAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3Q9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0fVxuICAgICAgICBvblJlc3BvbmRlckdyYW50PXt0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlckdyYW50fVxuICAgICAgICBvblJlc3BvbmRlck1vdmU9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyTW92ZX1cbiAgICAgICAgb25SZXNwb25kZXJSZWxlYXNlPXt0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclJlbGVhc2V9XG4gICAgICAgIG9uUmVzcG9uZGVyVGVybWluYXRlPXt0aGlzLnRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0ZX1cbiAgICAgICAgdGVzdElEPXt0aGlzLnByb3BzLnRlc3RJRH0+XG4gICAgICAgIHtSZWFjdC5jbG9uZUVsZW1lbnQoXG4gICAgICAgICAgUmVhY3QuQ2hpbGRyZW4ub25seSh0aGlzLnByb3BzLmNoaWxkcmVuKSxcbiAgICAgICAgICB7XG4gICAgICAgICAgICByZWY6IENISUxEX1JFRixcbiAgICAgICAgICB9XG4gICAgICAgICl9XG4gICAgICA8L1ZpZXc+XG4gICAgKTtcbiAgfVxuXG59O1xuXG5taXhpbi5vbkNsYXNzKFRvdWNoYWJsZUhpZ2hsaWdodCwgVGltZXJNaXhpbik7XG5taXhpbi5vbkNsYXNzKFRvdWNoYWJsZUhpZ2hsaWdodCwgVG91Y2hhYmxlTWl4aW4pO1xubWl4aW4ub25DbGFzcyhUb3VjaGFibGVIaWdobGlnaHQsIE5hdGl2ZU1ldGhvZHNNaXhpbik7XG5hdXRvYmluZChUb3VjaGFibGVIaWdobGlnaHQpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFRvdWNoYWJsZUhpZ2hsaWdodDtcbiJdfQ==