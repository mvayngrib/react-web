







'use strict';var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();

var _react=require('react');var _react2=_interopRequireDefault(_react);
var _ReactView=require('../View/View.web');var _ReactView2=_interopRequireDefault(_ReactView);
var _reactTimerMixin=require('react-timer-mixin');var _reactTimerMixin2=_interopRequireDefault(_reactTimerMixin);
var _ReactTouchableWithoutFeedback=require('./TouchableWithoutFeedback.web');var _ReactTouchableWithoutFeedback2=_interopRequireDefault(_ReactTouchableWithoutFeedback);
var _ReactTouchable=require('./Touchable');
var _NativeMethodsMixin=require('../Utilties/NativeMethodsMixin.web');
var _ReactStyleSheet=require('../StyleSheet/StyleSheet.web');var _ReactStyleSheet2=_interopRequireDefault(_ReactStyleSheet);
var _reactMixin=require('react-mixin');var _reactMixin2=_interopRequireDefault(_reactMixin);
var _autobindDecorator=require('autobind-decorator');var _autobindDecorator2=_interopRequireDefault(_autobindDecorator);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}



var DEFAULT_PROPS={
activeOpacity:0.8,
underlayColor:'black',
style:_ReactStyleSheet2.default.create({
cursor:'pointer'})};



var PRESS_RECT_OFFSET={top:20,left:20,right:20,bottom:30};
var CHILD_REF='childRef';
var UNDERLAY_REF='underlayRef';
var INACTIVE_CHILD_PROPS={
style:_ReactStyleSheet2.default.create({x:{opacity:1.0}}).x};

var INACTIVE_UNDERLAY_PROPS={
style:_ReactStyleSheet2.default.create({x:{backgroundColor:'transparent'}}).x};var


TouchableHighlight=function(_Component){_inherits(TouchableHighlight,_Component);function TouchableHighlight(){var _ref;var _temp,_this,_ret;_classCallCheck(this,TouchableHighlight);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=TouchableHighlight.__proto__||Object.getPrototypeOf(TouchableHighlight)).call.apply(_ref,[this].concat(args))),_this),_this.
























state=_extends({},_this.touchableGetInitialState(),_this.computeSyntheticState(_this.props)),_temp),_possibleConstructorReturn(_this,_ret);}_createClass(TouchableHighlight,[{key:'computeSyntheticState',value:function computeSyntheticState(


props){
return{
activeProps:{
style:{
opacity:props.activeOpacity}},


activeUnderlayProps:{
style:{
backgroundColor:props.underlayColor}},


underlayStyle:[
DEFAULT_PROPS.style,
INACTIVE_UNDERLAY_PROPS.style,
props.style]};


}},{key:'componentDidUpdate',value:function componentDidUpdate()






{

}},{key:'componentWillReceiveProps',value:function componentWillReceiveProps(

nextProps){

if(nextProps.activeOpacity!==this.props.activeOpacity||
nextProps.underlayColor!==this.props.underlayColor||
nextProps.style!==this.props.style){
this.setState(this.computeSyntheticState(nextProps));
}
}},{key:'touchableHandleActivePressIn',value:function touchableHandleActivePressIn(





e){
this.clearTimeout(this._hideTimeout);
this._hideTimeout=null;
this._showUnderlay();
this.props.onPressIn&&this.props.onPressIn(e);
}},{key:'touchableHandleActivePressOut',value:function touchableHandleActivePressOut(

e){
if(!this._hideTimeout){
this._hideUnderlay();
}
this.props.onPressOut&&this.props.onPressOut(e);
}},{key:'touchableHandlePress',value:function touchableHandlePress(

e){
this.clearTimeout(this._hideTimeout);
this._showUnderlay();
this._hideTimeout=this.setTimeout(this._hideUnderlay,
this.props.delayPressOut||100);

var touchBank=e.touchHistory.touchBank[e.touchHistory.indexOfSingleActiveTouch];
if(touchBank){
var offset=Math.sqrt(Math.pow(touchBank.startPageX-touchBank.currentPageX,2)+
Math.pow(touchBank.startPageY-touchBank.currentPageY,2));
var velocity=offset/(touchBank.currentTimeStamp-touchBank.startTimeStamp)*1000;
if(velocity<100)this.props.onPress&&this.props.onPress(e);
}else{
this.props.onPress&&this.props.onPress(e);
}
}},{key:'touchableHandleLongPress',value:function touchableHandleLongPress(

e){
this.props.onLongPress&&this.props.onLongPress(e);
}},{key:'touchableGetPressRectOffset',value:function touchableGetPressRectOffset()

{
return PRESS_RECT_OFFSET;
}},{key:'touchableGetHighlightDelayMS',value:function touchableGetHighlightDelayMS()

{
return this.props.delayPressIn;
}},{key:'touchableGetLongPressDelayMS',value:function touchableGetLongPressDelayMS()

{
return this.props.delayLongPress;
}},{key:'touchableGetPressOutDelayMS',value:function touchableGetPressOutDelayMS()

{
return this.props.delayPressOut;
}},{key:'_showUnderlay',value:function _showUnderlay()

{




this.refs[UNDERLAY_REF].setNativeProps(this.state.activeUnderlayProps);
this.refs[CHILD_REF].setNativeProps(this.state.activeProps);
this.props.onShowUnderlay&&this.props.onShowUnderlay();
}},{key:'_hideUnderlay',value:function _hideUnderlay()

{
this.clearTimeout(this._hideTimeout);
this._hideTimeout=null;
if(this.refs[UNDERLAY_REF]){
this.refs[CHILD_REF].setNativeProps(INACTIVE_CHILD_PROPS);
this.refs[UNDERLAY_REF].setNativeProps(_extends({},
INACTIVE_UNDERLAY_PROPS,{
style:this.state.underlayStyle}));

this.props.onHideUnderlay&&this.props.onHideUnderlay();
}
}},{key:'render',value:function render()

{

return(
_react2.default.createElement(_ReactView2.default,{
accessible:true,
accessibilityComponentType:this.props.accessibilityComponentType,
accessibilityTraits:this.props.accessibilityTraits,
ref:UNDERLAY_REF,
style:this.state.underlayStyle,
onLayout:this.props.onLayout,
onStartShouldSetResponder:this.touchableHandleStartShouldSetResponder,
onResponderTerminationRequest:this.touchableHandleResponderTerminationRequest,
onResponderGrant:this.touchableHandleResponderGrant,
onResponderMove:this.touchableHandleResponderMove,
onResponderRelease:this.touchableHandleResponderRelease,
onResponderTerminate:this.touchableHandleResponderTerminate,
testID:this.props.testID},
_react2.default.cloneElement(
_react2.default.Children.only(this.props.children),
{
ref:CHILD_REF})));




}}]);return TouchableHighlight;}(_react.Component);TouchableHighlight.propTypes=_extends({},_ReactTouchableWithoutFeedback2.default.propTypes,{activeOpacity:_react2.default.PropTypes.number,underlayColor:_react2.default.PropTypes.string,onShowUnderlay:_react2.default.PropTypes.func,onHideUnderlay:_react2.default.PropTypes.func});TouchableHighlight.defaultProps=DEFAULT_PROPS;

;

_reactMixin2.default.onClass(TouchableHighlight,_reactTimerMixin2.default);
_reactMixin2.default.onClass(TouchableHighlight,_ReactTouchable.Mixin);
_reactMixin2.default.onClass(TouchableHighlight,_NativeMethodsMixin.Mixin);
(0,_autobindDecorator2.default)(TouchableHighlight);

module.exports=TouchableHighlight;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlRvdWNoYWJsZUhpZ2hsaWdodC53ZWIuanMiXSwibmFtZXMiOlsiREVGQVVMVF9QUk9QUyIsImFjdGl2ZU9wYWNpdHkiLCJ1bmRlcmxheUNvbG9yIiwic3R5bGUiLCJjcmVhdGUiLCJjdXJzb3IiLCJQUkVTU19SRUNUX09GRlNFVCIsInRvcCIsImxlZnQiLCJyaWdodCIsImJvdHRvbSIsIkNISUxEX1JFRiIsIlVOREVSTEFZX1JFRiIsIklOQUNUSVZFX0NISUxEX1BST1BTIiwieCIsIm9wYWNpdHkiLCJJTkFDVElWRV9VTkRFUkxBWV9QUk9QUyIsImJhY2tncm91bmRDb2xvciIsIlRvdWNoYWJsZUhpZ2hsaWdodCIsInN0YXRlIiwidG91Y2hhYmxlR2V0SW5pdGlhbFN0YXRlIiwiY29tcHV0ZVN5bnRoZXRpY1N0YXRlIiwicHJvcHMiLCJhY3RpdmVQcm9wcyIsImFjdGl2ZVVuZGVybGF5UHJvcHMiLCJ1bmRlcmxheVN0eWxlIiwibmV4dFByb3BzIiwic2V0U3RhdGUiLCJlIiwiY2xlYXJUaW1lb3V0IiwiX2hpZGVUaW1lb3V0IiwiX3Nob3dVbmRlcmxheSIsIm9uUHJlc3NJbiIsIl9oaWRlVW5kZXJsYXkiLCJvblByZXNzT3V0Iiwic2V0VGltZW91dCIsImRlbGF5UHJlc3NPdXQiLCJ0b3VjaEJhbmsiLCJ0b3VjaEhpc3RvcnkiLCJpbmRleE9mU2luZ2xlQWN0aXZlVG91Y2giLCJvZmZzZXQiLCJNYXRoIiwic3FydCIsInBvdyIsInN0YXJ0UGFnZVgiLCJjdXJyZW50UGFnZVgiLCJzdGFydFBhZ2VZIiwiY3VycmVudFBhZ2VZIiwidmVsb2NpdHkiLCJjdXJyZW50VGltZVN0YW1wIiwic3RhcnRUaW1lU3RhbXAiLCJvblByZXNzIiwib25Mb25nUHJlc3MiLCJkZWxheVByZXNzSW4iLCJkZWxheUxvbmdQcmVzcyIsInJlZnMiLCJzZXROYXRpdmVQcm9wcyIsIm9uU2hvd1VuZGVybGF5Iiwib25IaWRlVW5kZXJsYXkiLCJhY2Nlc3NpYmlsaXR5Q29tcG9uZW50VHlwZSIsImFjY2Vzc2liaWxpdHlUcmFpdHMiLCJvbkxheW91dCIsInRvdWNoYWJsZUhhbmRsZVN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyIiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0IiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyR3JhbnQiLCJ0b3VjaGFibGVIYW5kbGVSZXNwb25kZXJNb3ZlIiwidG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyUmVsZWFzZSIsInRvdWNoYWJsZUhhbmRsZVJlc3BvbmRlclRlcm1pbmF0ZSIsInRlc3RJRCIsImNsb25lRWxlbWVudCIsIkNoaWxkcmVuIiwib25seSIsImNoaWxkcmVuIiwicmVmIiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwibnVtYmVyIiwic3RyaW5nIiwiZnVuYyIsImRlZmF1bHRQcm9wcyIsIm9uQ2xhc3MiLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQVFBLGE7O0FBRUEsNEI7QUFDQSwyQztBQUNBLGtEO0FBQ0EsNkU7QUFDQTtBQUNBO0FBQ0EsNkQ7QUFDQSx1QztBQUNBLHFEOzs7O0FBSUEsR0FBSUEsZUFBZ0I7QUFDbEJDLGNBQWUsR0FERztBQUVsQkMsY0FBZSxPQUZHO0FBR2xCQyxNQUFPLDBCQUFXQyxNQUFYLENBQWtCO0FBQ3ZCQyxPQUFRLFNBRGUsQ0FBbEIsQ0FIVyxDQUFwQjs7OztBQVFBLEdBQUlDLG1CQUFvQixDQUFDQyxJQUFLLEVBQU4sQ0FBVUMsS0FBTSxFQUFoQixDQUFvQkMsTUFBTyxFQUEzQixDQUErQkMsT0FBUSxFQUF2QyxDQUF4QjtBQUNBLEdBQUlDLFdBQVksVUFBaEI7QUFDQSxHQUFJQyxjQUFlLGFBQW5CO0FBQ0EsR0FBSUMsc0JBQXVCO0FBQ3pCVixNQUFPLDBCQUFXQyxNQUFYLENBQWtCLENBQUNVLEVBQUcsQ0FBQ0MsUUFBUyxHQUFWLENBQUosQ0FBbEIsRUFBdUNELENBRHJCLENBQTNCOztBQUdBLEdBQUlFLHlCQUEwQjtBQUM1QmIsTUFBTyww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QUtFLE1BQU8sS0FBS08sS0FBTCxDQUFXTSxhQUxwQjtBQU1FLFNBQVUsS0FBS0gsS0FBTCxDQUFXdUMsUUFOdkI7QUFPRSwwQkFBMkIsS0FBS0Msc0NBUGxDO0FBUUUsOEJBQStCLEtBQUtDLDBDQVJ0QztBQVNFLGlCQUFrQixLQUFLQyw2QkFUekI7QUFVRSxnQkFBaUIsS0FBS0MsNEJBVnhCO0FBV0UsbUJBQW9CLEtBQUtDLCtCQVgzQjtBQVlFLHFCQUFzQixLQUFLQyxpQ0FaN0I7QUFhRSxPQUFRLEtBQUs3QyxLQUFMLENBQVc4QyxNQWJyQjtBQWNHLGdCQUFNQyxZQUFOO0FBQ0MsZ0JBQU1DLFFBQU4sQ0FBZUMsSUFBZixDQUFvQixLQUFLakQsS0FBTCxDQUFXa0QsUUFBL0IsQ0FERDtBQUVDO0FBQ0VDLElBQUs5RCxTQURQLENBRkQsQ0FkSCxDQURGOzs7OztBQXVCRCxDLGtEQXpLR08sa0IsQ0FDR3dELFMsYUFDRix3Q0FBeUJBLFMsRUFLNUJ6RSxjQUFlLGdCQUFNMEUsU0FBTixDQUFnQkMsTSxDQUsvQjFFLGNBQWUsZ0JBQU15RSxTQUFOLENBQWdCRSxNLENBSS9CcEIsZUFBZ0IsZ0JBQU1rQixTQUFOLENBQWdCRyxJLENBSWhDcEIsZUFBZ0IsZ0JBQU1pQixTQUFOLENBQWdCRyxJLEdBcEI5QjVELGtCLENBdUJHNkQsWSxDQUFlL0UsYTs7QUFvSnZCOztBQUVELHFCQUFNZ0YsT0FBTixDQUFjOUQsa0JBQWQ7QUFDQSxxQkFBTThELE9BQU4sQ0FBYzlELGtCQUFkO0FBQ0EscUJBQU04RCxPQUFOLENBQWM5RCxrQkFBZDtBQUNBLGdDQUFTQSxrQkFBVDs7QUFFQStELE9BQU9DLE9BQVAsQ0FBaUJoRSxrQkFBakIiLCJmaWxlIjoiVG91Y2hhYmxlSGlnaGxpZ2h0LndlYi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSAyMDE1LXByZXNlbnQsIEFsaWJhYmEgR3JvdXAgSG9sZGluZyBMaW1pdGVkLlxuICogQWxsIHJpZ2h0cyByZXNlcnZlZC5cbiAqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUsIEZhY2Vib29rLCBJbmMuICBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIEBwcm92aWRlc01vZHVsZSBSZWFjdFRvdWNoYWJsZUhpZ2hsaWdodFxuICovXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCBSZWFjdCwgeyBDb21wb25lbnQgfSBmcm9tICdyZWFjdCc7XG5pbXBvcnQgVmlldyBmcm9tICdSZWFjdFZpZXcnO1xuaW1wb3J0IFRpbWVyTWl4aW4gZnJvbSAncmVhY3QtdGltZXItbWl4aW4nO1xuaW1wb3J0IFRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayBmcm9tICdSZWFjdFRvdWNoYWJsZVdpdGhvdXRGZWVkYmFjayc7XG5pbXBvcnQgeyBNaXhpbiBhcyBUb3VjaGFibGVNaXhpbiB9IGZyb20gJ1JlYWN0VG91Y2hhYmxlJztcbmltcG9ydCB7IE1peGluIGFzIE5hdGl2ZU1ldGhvZHNNaXhpbiB9IGZyb20gJ05hdGl2ZU1ldGhvZHNNaXhpbic7XG5pbXBvcnQgU3R5bGVTaGVldCBmcm9tICdSZWFjdFN0eWxlU2hlZXQnO1xuaW1wb3J0IG1peGluIGZyb20gJ3JlYWN0LW1peGluJztcbmltcG9ydCBhdXRvYmluZCBmcm9tICdhdXRvYmluZC1kZWNvcmF0b3InO1xuXG50eXBlIEV2ZW50ID0gT2JqZWN0O1xuXG52YXIgREVGQVVMVF9QUk9QUyA9IHtcbiAgYWN0aXZlT3BhY2l0eTogMC44LFxuICB1bmRlcmxheUNvbG9yOiAnYmxhY2snLFxuICBzdHlsZTogU3R5bGVTaGVldC5jcmVhdGUoe1xuICAgIGN1cnNvcjogJ3BvaW50ZXInXG4gIH0pXG59O1xuXG52YXIgUFJFU1NfUkVDVF9PRkZTRVQgPSB7dG9wOiAyMCwgbGVmdDogMjAsIHJpZ2h0OiAyMCwgYm90dG9tOiAzMH07XG52YXIgQ0hJTERfUkVGID0gJ2NoaWxkUmVmJztcbnZhciBVTkRFUkxBWV9SRUYgPSAndW5kZXJsYXlSZWYnO1xudmFyIElOQUNUSVZFX0NISUxEX1BST1BTID0ge1xuICBzdHlsZTogU3R5bGVTaGVldC5jcmVhdGUoe3g6IHtvcGFjaXR5OiAxLjB9fSkueCxcbn07XG52YXIgSU5BQ1RJVkVfVU5ERVJMQVlfUFJPUFMgPSB7XG4gIHN0eWxlOiBTdHlsZVNoZWV0LmNyZWF0ZSh7eDoge2JhY2tncm91bmRDb2xvcjogJ3RyYW5zcGFyZW50J319KS54LFxufTtcblxuY2xhc3MgVG91Y2hhYmxlSGlnaGxpZ2h0IGV4dGVuZHMgQ29tcG9uZW50IHtcbiAgc3RhdGljIHByb3BUeXBlcyA9IHtcbiAgICAuLi5Ub3VjaGFibGVXaXRob3V0RmVlZGJhY2sucHJvcFR5cGVzLFxuICAgIC8qKlxuICAgICAqIERldGVybWluZXMgd2hhdCB0aGUgb3BhY2l0eSBvZiB0aGUgd3JhcHBlZCB2aWV3IHNob3VsZCBiZSB3aGVuIHRvdWNoIGlzXG4gICAgICogYWN0aXZlLlxuICAgICAqL1xuICAgIGFjdGl2ZU9wYWNpdHk6IFJlYWN0LlByb3BUeXBlcy5udW1iZXIsXG4gICAgLyoqXG4gICAgICogVGhlIGNvbG9yIG9mIHRoZSB1bmRlcmxheSB0aGF0IHdpbGwgc2hvdyB0aHJvdWdoIHdoZW4gdGhlIHRvdWNoIGlzXG4gICAgICogYWN0aXZlLlxuICAgICAqL1xuICAgIHVuZGVybGF5Q29sb3I6IFJlYWN0LlByb3BUeXBlcy5zdHJpbmcsXG4gICAgLyoqXG4gICAgICogQ2FsbGVkIGltbWVkaWF0ZWx5IGFmdGVyIHRoZSB1bmRlcmxheSBpcyBzaG93blxuICAgICAqL1xuICAgIG9uU2hvd1VuZGVybGF5OiBSZWFjdC5Qcm9wVHlwZXMuZnVuYyxcbiAgICAvKipcbiAgICAgKiBDYWxsZWQgaW1tZWRpYXRlbHkgYWZ0ZXIgdGhlIHVuZGVybGF5IGlzIGhpZGRlblxuICAgICAqL1xuICAgIG9uSGlkZVVuZGVybGF5OiBSZWFjdC5Qcm9wVHlwZXMuZnVuYyxcbiAgfVxuXG4gIHN0YXRpYyBkZWZhdWx0UHJvcHMgPSBERUZBVUxUX1BST1BTXG5cbiAgc3RhdGUgPSB7Li4udGhpcy50b3VjaGFibGVHZXRJbml0aWFsU3RhdGUoKSwgLi4udGhpcy5jb21wdXRlU3ludGhldGljU3RhdGUodGhpcy5wcm9wcyl9XG5cbiAgLy8gUGVyZm9ybWFuY2Ugb3B0aW1pemF0aW9uIHRvIGF2b2lkIGNvbnN0YW50bHkgcmUtZ2VuZXJhdGluZyB0aGVzZSBvYmplY3RzLlxuICBjb21wdXRlU3ludGhldGljU3RhdGUocHJvcHMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgYWN0aXZlUHJvcHM6IHtcbiAgICAgICAgc3R5bGU6IHtcbiAgICAgICAgICBvcGFjaXR5OiBwcm9wcy5hY3RpdmVPcGFjaXR5LFxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgYWN0aXZlVW5kZXJsYXlQcm9wczoge1xuICAgICAgICBzdHlsZToge1xuICAgICAgICAgIGJhY2tncm91bmRDb2xvcjogcHJvcHMudW5kZXJsYXlDb2xvcixcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHVuZGVybGF5U3R5bGU6IFtcbiAgICAgICAgREVGQVVMVF9QUk9QUy5zdHlsZSxcbiAgICAgICAgSU5BQ1RJVkVfVU5ERVJMQVlfUFJPUFMuc3R5bGUsXG4gICAgICAgIHByb3BzLnN0eWxlLFxuICAgICAgXVxuICAgIH07XG4gIH1cblxuICAvLyBjb21wb25lbnREaWRNb3VudCgpIHtcbiAgLy8gICAvLyBlbnN1cmVQb3NpdGl2ZURlbGF5UHJvcHModGhpcy5wcm9wcyk7XG4gIC8vICAgLy8gZW5zdXJlQ29tcG9uZW50SXNOYXRpdmUodGhpcy5yZWZzW0NISUxEX1JFRl0pO1xuICAvLyB9LFxuXG4gIGNvbXBvbmVudERpZFVwZGF0ZSgpIHtcbiAgICAvLyBlbnN1cmVDb21wb25lbnRJc05hdGl2ZSh0aGlzLnJlZnNbQ0hJTERfUkVGXSk7XG4gIH1cblxuICBjb21wb25lbnRXaWxsUmVjZWl2ZVByb3BzKG5leHRQcm9wcykge1xuICAgIC8vIGVuc3VyZVBvc2l0aXZlRGVsYXlQcm9wcyhuZXh0UHJvcHMpO1xuICAgIGlmIChuZXh0UHJvcHMuYWN0aXZlT3BhY2l0eSAhPT0gdGhpcy5wcm9wcy5hY3RpdmVPcGFjaXR5IHx8XG4gICAgICAgIG5leHRQcm9wcy51bmRlcmxheUNvbG9yICE9PSB0aGlzLnByb3BzLnVuZGVybGF5Q29sb3IgfHxcbiAgICAgICAgbmV4dFByb3BzLnN0eWxlICE9PSB0aGlzLnByb3BzLnN0eWxlKSB7XG4gICAgICB0aGlzLnNldFN0YXRlKHRoaXMuY29tcHV0ZVN5bnRoZXRpY1N0YXRlKG5leHRQcm9wcykpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBgVG91Y2hhYmxlLk1peGluYCBzZWxmIGNhbGxiYWNrcy4gVGhlIG1peGluIHdpbGwgaW52b2tlIHRoZXNlIGlmIHRoZXkgYXJlXG4gICAqIGRlZmluZWQgb24geW91ciBjb21wb25lbnQuXG4gICAqL1xuICB0b3VjaGFibGVIYW5kbGVBY3RpdmVQcmVzc0luKGU6IEV2ZW50KSB7XG4gICAgdGhpcy5jbGVhclRpbWVvdXQodGhpcy5faGlkZVRpbWVvdXQpO1xuICAgIHRoaXMuX2hpZGVUaW1lb3V0ID0gbnVsbDtcbiAgICB0aGlzLl9zaG93VW5kZXJsYXkoKTtcbiAgICB0aGlzLnByb3BzLm9uUHJlc3NJbiAmJiB0aGlzLnByb3BzLm9uUHJlc3NJbihlKTtcbiAgfVxuXG4gIHRvdWNoYWJsZUhhbmRsZUFjdGl2ZVByZXNzT3V0KGU6IEV2ZW50KSB7XG4gICAgaWYgKCF0aGlzLl9oaWRlVGltZW91dCkge1xuICAgICAgdGhpcy5faGlkZVVuZGVybGF5KCk7XG4gICAgfVxuICAgIHRoaXMucHJvcHMub25QcmVzc091dCAmJiB0aGlzLnByb3BzLm9uUHJlc3NPdXQoZSk7XG4gIH1cblxuICB0b3VjaGFibGVIYW5kbGVQcmVzcyhlOiBFdmVudCkge1xuICAgIHRoaXMuY2xlYXJUaW1lb3V0KHRoaXMuX2hpZGVUaW1lb3V0KTtcbiAgICB0aGlzLl9zaG93VW5kZXJsYXkoKTtcbiAgICB0aGlzLl9oaWRlVGltZW91dCA9IHRoaXMuc2V0VGltZW91dCh0aGlzLl9oaWRlVW5kZXJsYXksXG4gICAgICB0aGlzLnByb3BzLmRlbGF5UHJlc3NPdXQgfHwgMTAwKTtcblxuICAgIHZhciB0b3VjaEJhbmsgPSBlLnRvdWNoSGlzdG9yeS50b3VjaEJhbmtbZS50b3VjaEhpc3RvcnkuaW5kZXhPZlNpbmdsZUFjdGl2ZVRvdWNoXTtcbiAgICBpZiAodG91Y2hCYW5rKSB7XG4gICAgICB2YXIgb2Zmc2V0ID0gTWF0aC5zcXJ0KE1hdGgucG93KHRvdWNoQmFuay5zdGFydFBhZ2VYIC0gdG91Y2hCYW5rLmN1cnJlbnRQYWdlWCwgMilcbiAgICAgICAgICArIE1hdGgucG93KHRvdWNoQmFuay5zdGFydFBhZ2VZIC0gdG91Y2hCYW5rLmN1cnJlbnRQYWdlWSwgMikpO1xuICAgICAgdmFyIHZlbG9jaXR5ID0gKG9mZnNldCAvICh0b3VjaEJhbmsuY3VycmVudFRpbWVTdGFtcCAtIHRvdWNoQmFuay5zdGFydFRpbWVTdGFtcCkpICogMTAwMDtcbiAgICAgIGlmICh2ZWxvY2l0eSA8IDEwMCkgdGhpcy5wcm9wcy5vblByZXNzICYmIHRoaXMucHJvcHMub25QcmVzcyhlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5wcm9wcy5vblByZXNzICYmIHRoaXMucHJvcHMub25QcmVzcyhlKTtcbiAgICB9XG4gIH1cblxuICB0b3VjaGFibGVIYW5kbGVMb25nUHJlc3MoZTogRXZlbnQpIHtcbiAgICB0aGlzLnByb3BzLm9uTG9uZ1ByZXNzICYmIHRoaXMucHJvcHMub25Mb25nUHJlc3MoZSk7XG4gIH1cblxuICB0b3VjaGFibGVHZXRQcmVzc1JlY3RPZmZzZXQoKSB7XG4gICAgcmV0dXJuIFBSRVNTX1JFQ1RfT0ZGU0VUOyAgIC8vIEFsd2F5cyBtYWtlIHN1cmUgdG8gcHJlZGVjbGFyZSBhIGNvbnN0YW50IVxuICB9XG5cbiAgdG91Y2hhYmxlR2V0SGlnaGxpZ2h0RGVsYXlNUygpIHtcbiAgICByZXR1cm4gdGhpcy5wcm9wcy5kZWxheVByZXNzSW47XG4gIH1cblxuICB0b3VjaGFibGVHZXRMb25nUHJlc3NEZWxheU1TKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BzLmRlbGF5TG9uZ1ByZXNzO1xuICB9XG5cbiAgdG91Y2hhYmxlR2V0UHJlc3NPdXREZWxheU1TKCkge1xuICAgIHJldHVybiB0aGlzLnByb3BzLmRlbGF5UHJlc3NPdXQ7XG4gIH1cblxuICBfc2hvd1VuZGVybGF5KCkge1xuICAgIC8vIGlmICghdGhpcy5pc01vdW50ZWQoKSkge1xuICAgIC8vICAgcmV0dXJuO1xuICAgIC8vIH1cblxuICAgIHRoaXMucmVmc1tVTkRFUkxBWV9SRUZdLnNldE5hdGl2ZVByb3BzKHRoaXMuc3RhdGUuYWN0aXZlVW5kZXJsYXlQcm9wcyk7XG4gICAgdGhpcy5yZWZzW0NISUxEX1JFRl0uc2V0TmF0aXZlUHJvcHModGhpcy5zdGF0ZS5hY3RpdmVQcm9wcyk7XG4gICAgdGhpcy5wcm9wcy5vblNob3dVbmRlcmxheSAmJiB0aGlzLnByb3BzLm9uU2hvd1VuZGVybGF5KCk7XG4gIH1cblxuICBfaGlkZVVuZGVybGF5KCkge1xuICAgIHRoaXMuY2xlYXJUaW1lb3V0KHRoaXMuX2hpZGVUaW1lb3V0KTtcbiAgICB0aGlzLl9oaWRlVGltZW91dCA9IG51bGw7XG4gICAgaWYgKHRoaXMucmVmc1tVTkRFUkxBWV9SRUZdKSB7XG4gICAgICB0aGlzLnJlZnNbQ0hJTERfUkVGXS5zZXROYXRpdmVQcm9wcyhJTkFDVElWRV9DSElMRF9QUk9QUyk7XG4gICAgICB0aGlzLnJlZnNbVU5ERVJMQVlfUkVGXS5zZXROYXRpdmVQcm9wcyh7XG4gICAgICAgIC4uLklOQUNUSVZFX1VOREVSTEFZX1BST1BTLFxuICAgICAgICBzdHlsZTogdGhpcy5zdGF0ZS51bmRlcmxheVN0eWxlLFxuICAgICAgfSk7XG4gICAgICB0aGlzLnByb3BzLm9uSGlkZVVuZGVybGF5ICYmIHRoaXMucHJvcHMub25IaWRlVW5kZXJsYXkoKTtcbiAgICB9XG4gIH1cblxuICByZW5kZXIoKSB7XG5cbiAgICByZXR1cm4gKFxuICAgICAgPFZpZXdcbiAgICAgICAgYWNjZXNzaWJsZT17dHJ1ZX1cbiAgICAgICAgYWNjZXNzaWJpbGl0eUNvbXBvbmVudFR5cGU9e3RoaXMucHJvcHMuYWNjZXNzaWJpbGl0eUNvbXBvbmVudFR5cGV9XG4gICAgICAgIGFjY2Vzc2liaWxpdHlUcmFpdHM9e3RoaXMucHJvcHMuYWNjZXNzaWJpbGl0eVRyYWl0c31cbiAgICAgICAgcmVmPXtVTkRFUkxBWV9SRUZ9XG4gICAgICAgIHN0eWxlPXt0aGlzLnN0YXRlLnVuZGVybGF5U3R5bGV9XG4gICAgICAgIG9uTGF5b3V0PXt0aGlzLnByb3BzLm9uTGF5b3V0fVxuICAgICAgICBvblN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyPXt0aGlzLnRvdWNoYWJsZUhhbmRsZVN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyfVxuICAgICAgICBvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdD17dGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJUZXJtaW5hdGlvblJlcXVlc3R9XG4gICAgICAgIG9uUmVzcG9uZGVyR3JhbnQ9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyR3JhbnR9XG4gICAgICAgIG9uUmVzcG9uZGVyTW92ZT17dGhpcy50b3VjaGFibGVIYW5kbGVSZXNwb25kZXJNb3ZlfVxuICAgICAgICBvblJlc3BvbmRlclJlbGVhc2U9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyUmVsZWFzZX1cbiAgICAgICAgb25SZXNwb25kZXJUZXJtaW5hdGU9e3RoaXMudG91Y2hhYmxlSGFuZGxlUmVzcG9uZGVyVGVybWluYXRlfVxuICAgICAgICB0ZXN0SUQ9e3RoaXMucHJvcHMudGVzdElEfT5cbiAgICAgICAge1JlYWN0LmNsb25lRWxlbWVudChcbiAgICAgICAgICBSZWFjdC5DaGlsZHJlbi5vbmx5KHRoaXMucHJvcHMuY2hpbGRyZW4pLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHJlZjogQ0hJTERfUkVGLFxuICAgICAgICAgIH1cbiAgICAgICAgKX1cbiAgICAgIDwvVmlldz5cbiAgICApO1xuICB9XG5cbn07XG5cbm1peGluLm9uQ2xhc3MoVG91Y2hhYmxlSGlnaGxpZ2h0LCBUaW1lck1peGluKTtcbm1peGluLm9uQ2xhc3MoVG91Y2hhYmxlSGlnaGxpZ2h0LCBUb3VjaGFibGVNaXhpbik7XG5taXhpbi5vbkNsYXNzKFRvdWNoYWJsZUhpZ2hsaWdodCwgTmF0aXZlTWV0aG9kc01peGluKTtcbmF1dG9iaW5kKFRvdWNoYWJsZUhpZ2hsaWdodCk7XG5cbm1vZHVsZS5leHBvcnRzID0gVG91Y2hhYmxlSGlnaGxpZ2h0O1xuIl19