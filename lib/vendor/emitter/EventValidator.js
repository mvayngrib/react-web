















'use strict';

var _copyProperties=require('../core/copyProperties');var _copyProperties2=_interopRequireDefault(_copyProperties);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}










var EventValidator={










addValidation:function addValidation(emitter,types){
var eventTypes=Object.keys(types);
var emitterWithValidation=Object.create(emitter);

(0,_copyProperties2.default)(emitterWithValidation,{
emit:function emit(type,a,b,c,d,e,_){
assertAllowsEventType(type,eventTypes);
return emitter.emit.call(this,type,a,b,c,d,e,_);
}});


return emitterWithValidation;
}};


function assertAllowsEventType(type,allowedTypes){
if(allowedTypes.indexOf(type)===-1){
throw new TypeError(errorMessageFor(type,allowedTypes));
}
}

function errorMessageFor(type,allowedTypes){
var message='Unknown event type "'+type+'". ';
if(__DEV__){
message+=recommendationFor(type,allowedTypes);
}
message+='Known event types: '+allowedTypes.join(', ')+'.';
return message;
}


if(__DEV__){
var recommendationFor=function recommendationFor(type,allowedTypes){
var closestTypeRecommendation=closestTypeFor(type,allowedTypes);
if(isCloseEnough(closestTypeRecommendation,type)){
return'Did you mean "'+closestTypeRecommendation.type+'"? ';
}else{
return'';
}
};

var closestTypeFor=function closestTypeFor(type,allowedTypes){
var typeRecommendations=allowedTypes.map(
typeRecommendationFor.bind(this,type));

return typeRecommendations.sort(recommendationSort)[0];
};

var typeRecommendationFor=function typeRecommendationFor(type,recomendedType){
return{
type:recomendedType,
distance:damerauLevenshteinDistance(type,recomendedType)};

};

var recommendationSort=function recommendationSort(recommendationA,recommendationB){
if(recommendationA.distance<recommendationB.distance){
return-1;
}else if(recommendationA.distance>recommendationB.distance){
return 1;
}else{
return 0;
}
};

var isCloseEnough=function isCloseEnough(closestType,actualType){
return closestType.distance/actualType.length<0.334;
};

var damerauLevenshteinDistance=function damerauLevenshteinDistance(a,b){
var i,j;
var d=[];

for(i=0;i<=a.length;i++){
d[i]=[i];
}

for(j=1;j<=b.length;j++){
d[0][j]=j;
}

for(i=1;i<=a.length;i++){
for(j=1;j<=b.length;j++){
var cost=a.charAt(i-1)===b.charAt(j-1)?0:1;

d[i][j]=Math.min(
d[i-1][j]+1,
d[i][j-1]+1,
d[i-1][j-1]+cost);


if(i>1&&j>1&&
a.charAt(i-1)==b.charAt(j-2)&&
a.charAt(i-2)==b.charAt(j-1)){
d[i][j]=Math.min(d[i][j],d[i-2][j-2]+cost);
}
}
}

return d[a.length][b.length];
};
}

module.exports=EventValidator;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIkV2ZW50VmFsaWRhdG9yLmpzIl0sIm5hbWVzIjpbIkV2ZW50VmFsaWRhdG9yIiwiYWRkVmFsaWRhdGlvbiIsImVtaXR0ZXIiLCJ0eXBlcyIsImV2ZW50VHlwZXMiLCJPYmplY3QiLCJrZXlzIiwiZW1pdHRlcldpdGhWYWxpZGF0aW9uIiwiY3JlYXRlIiwiZW1pdCIsInR5cGUiLCJhIiwiYiIsImMiLCJkIiwiZSIsIl8iLCJhc3NlcnRBbGxvd3NFdmVudFR5cGUiLCJjYWxsIiwiYWxsb3dlZFR5cGVzIiwiaW5kZXhPZiIsIlR5cGVFcnJvciIsImVycm9yTWVzc2FnZUZvciIsIm1lc3NhZ2UiLCJfX0RFVl9fIiwicmVjb21tZW5kYXRpb25Gb3IiLCJqb2luIiwiY2xvc2VzdFR5cGVSZWNvbW1lbmRhdGlvbiIsImNsb3Nlc3RUeXBlRm9yIiwiaXNDbG9zZUVub3VnaCIsInR5cGVSZWNvbW1lbmRhdGlvbnMiLCJtYXAiLCJ0eXBlUmVjb21tZW5kYXRpb25Gb3IiLCJiaW5kIiwic29ydCIsInJlY29tbWVuZGF0aW9uU29ydCIsInJlY29tZW5kZWRUeXBlIiwiZGlzdGFuY2UiLCJkYW1lcmF1TGV2ZW5zaHRlaW5EaXN0YW5jZSIsInJlY29tbWVuZGF0aW9uQSIsInJlY29tbWVuZGF0aW9uQiIsImNsb3Nlc3RUeXBlIiwiYWN0dWFsVHlwZSIsImxlbmd0aCIsImkiLCJqIiwiY29zdCIsImNoYXJBdCIsIk1hdGgiLCJtaW4iLCJtb2R1bGUiLCJleHBvcnRzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBZ0JBOztBQUVBLHNEOzs7Ozs7Ozs7OztBQVdBLEdBQUlBLGdCQUFpQjs7Ozs7Ozs7Ozs7QUFXbkJDLGNBQWUsdUJBQVNDLE9BQVQsQ0FBMEJDLEtBQTFCLENBQXlDO0FBQ3RELEdBQUlDLFlBQWFDLE9BQU9DLElBQVAsQ0FBWUgsS0FBWixDQUFqQjtBQUNBLEdBQUlJLHVCQUF3QkYsT0FBT0csTUFBUCxDQUFjTixPQUFkLENBQTVCOztBQUVBLDZCQUFl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Q0FBU0YsRUFBSSxDQUFiLENBRG5CO0FBRUFsQyxFQUFFb0MsTUFBRixDQUFTSCxFQUFJLENBQWIsR0FBbUJoQyxFQUFFbUMsTUFBRixDQUFTRixFQUFJLENBQWIsQ0FGdkIsQ0FFd0M7QUFDdEMvQixFQUFFOEIsQ0FBRixFQUFLQyxDQUFMLEVBQVVHLEtBQUtDLEdBQUwsQ0FBU25DLEVBQUU4QixDQUFGLEVBQUtDLENBQUwsQ0FBVCxDQUFrQi9CLEVBQUU4QixFQUFJLENBQU4sRUFBU0MsRUFBSSxDQUFiLEVBQWtCQyxJQUFwQyxDQUFWO0FBQ0Q7QUFDRjtBQUNGOztBQUVELE1BQU9oQyxHQUFFSCxFQUFFZ0MsTUFBSixFQUFZL0IsRUFBRStCLE1BQWQsQ0FBUDtBQUNELENBL0JEO0FBZ0NEOztBQUVETyxPQUFPQyxPQUFQLENBQWlCbkQsY0FBakIiLCJmaWxlIjoiRXZlbnRWYWxpZGF0b3IuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEBnZW5lcmF0ZWQgU2lnbmVkU291cmNlPDw3MTQ5YmRhYzZmYjQ4NTk1ZjI0NWFkNmU3NjkzOGU0ND4+XG4gKlxuICogISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhIVxuICogISEgVGhpcyBmaWxlIGlzIGEgY2hlY2staW4gb2YgYSBzdGF0aWNfdXBzdHJlYW0gcHJvamVjdCEgICAgICAhIVxuICogISEgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhIVxuICogISEgWW91IHNob3VsZCBub3QgbW9kaWZ5IHRoaXMgZmlsZSBkaXJlY3RseS4gSW5zdGVhZDogICAgICAgICAhIVxuICogISEgMSkgVXNlIGBmanMgdXNlLXVwc3RyZWFtYCB0byB0ZW1wb3JhcmlseSByZXBsYWNlIHRoaXMgd2l0aCAhIVxuICogISEgICAgdGhlIGxhdGVzdCB2ZXJzaW9uIGZyb20gdXBzdHJlYW0uICAgICAgICAgICAgICAgICAgICAgICAhIVxuICogISEgMikgTWFrZSB5b3VyIGNoYW5nZXMsIHRlc3QgdGhlbSwgZXRjLiAgICAgICAgICAgICAgICAgICAgICAhIVxuICogISEgMykgVXNlIGBmanMgcHVzaC11cHN0cmVhbWAgdG8gY29weSB5b3VyIGNoYW5nZXMgYmFjayB0byAgICAhIVxuICogISEgICAgc3RhdGljX3Vwc3RyZWFtLiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAhIVxuICogISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhISEhIVxuICpcbiAqIEBwcm92aWRlc01vZHVsZSBFdmVudFZhbGlkYXRvclxuICovXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCBjb3B5UHJvcGVydGllcyBmcm9tICdjb3B5UHJvcGVydGllcyc7XG5cbi8qKlxuICogRXZlbnRWYWxpZGF0b3IgaXMgZGVzaWduZWQgdG8gdmFsaWRhdGUgZXZlbnQgdHlwZXMgdG8gbWFrZSBpdCBlYXNpZXIgdG8gY2F0Y2hcbiAqIGNvbW1vbiBtaXN0YWtlcy4gSXQgYWNjZXB0cyBhIG1hcCBvZiBhbGwgb2YgdGhlIGRpZmZlcmVudCB0eXBlcyBvZiBldmVudHNcbiAqIHRoYXQgdGhlIGVtaXR0ZXIgY2FuIGVtaXQuIFRoZW4sIGlmIGEgdXNlciBhdHRlbXB0cyB0byBlbWl0IGFuIGV2ZW50IHRoYXQgaXNcbiAqIG5vdCBvbmUgb2YgdGhvc2Ugc3BlY2lmaWVkIHR5cGVzIHRoZSBlbWl0dGVyIHdpbGwgdGhyb3cgYW4gZXJyb3IuIEFsc28sIGl0XG4gKiBwcm92aWRlcyBhIHJlbGF0aXZlbHkgc2ltcGxlIG1hdGNoZXIgc28gdGhhdCBpZiBpdCB0aGlua3MgdGhhdCB5b3UgbGlrZWx5XG4gKiBtaXN0eXBlZCB0aGUgZXZlbnQgbmFtZSBpdCB3aWxsIHN1Z2dlc3Qgd2hhdCB5b3UgbWlnaHQgaGF2ZSBtZWFudCB0byB0eXBlIGluXG4gKiB0aGUgZXJyb3IgbWVzc2FnZS5cbiAqL1xudmFyIEV2ZW50VmFsaWRhdG9yID0ge1xuICAvKipcbiAgICogQHBhcmFtIHtPYmplY3R9IGVtaXR0ZXIgLSBUaGUgb2JqZWN0IHJlc3BvbnNpYmxlIGZvciBlbWl0dGluZyB0aGUgYWN0dWFsXG4gICAqICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudHNcbiAgICogQHBhcmFtIHtPYmplY3R9IHR5cGVzIC0gVGhlIGNvbGxlY3Rpb24gb2YgdmFsaWQgdHlwZXMgdGhhdCB3aWxsIGJlIHVzZWQgdG9cbiAgICogICAgICAgICAgICAgICAgICAgICAgICAgY2hlY2sgZm9yIGVycm9yc1xuICAgKiBAcmV0dXJuIHtPYmplY3R9IEEgbmV3IGVtaXR0ZXIgd2l0aCBldmVudCB0eXBlIHZhbGlkYXRpb25cbiAgICogQGV4YW1wbGVcbiAgICogICB2YXIgdHlwZXMgPSB7c29tZUV2ZW50OiB0cnVlLCBhbm90aGVyRXZlbnQ6IHRydWV9O1xuICAgKiAgIHZhciBlbWl0dGVyID0gRXZlbnRWYWxpZGF0b3IuYWRkVmFsaWRhdGlvbihlbWl0dGVyLCB0eXBlcyk7XG4gICAqL1xuICBhZGRWYWxpZGF0aW9uOiBmdW5jdGlvbihlbWl0dGVyOiBPYmplY3QsIHR5cGVzOiBPYmplY3QpIHtcbiAgICB2YXIgZXZlbnRUeXBlcyA9IE9iamVjdC5rZXlzKHR5cGVzKTtcbiAgICB2YXIgZW1pdHRlcldpdGhWYWxpZGF0aW9uID0gT2JqZWN0LmNyZWF0ZShlbWl0dGVyKTtcblxuICAgIGNvcHlQcm9wZXJ0aWVzKGVtaXR0ZXJXaXRoVmFsaWRhdGlvbiwge1xuICAgICAgZW1pdDogZnVuY3Rpb24gZW1pdCh0eXBlLCBhLCBiLCBjLCBkLCBlLCBfKSB7XG4gICAgICAgIGFzc2VydEFsbG93c0V2ZW50VHlwZSh0eXBlLCBldmVudFR5cGVzKTtcbiAgICAgICAgcmV0dXJuIGVtaXR0ZXIuZW1pdC5jYWxsKHRoaXMsIHR5cGUsIGEsIGIsIGMsIGQsIGUsIF8pO1xuICAgICAgfVxuICAgIH0pO1xuXG4gICAgcmV0dXJuIGVtaXR0ZXJXaXRoVmFsaWRhdGlvbjtcbiAgfVxufTtcblxuZnVuY3Rpb24gYXNzZXJ0QWxsb3dzRXZlbnRUeXBlKHR5cGUsIGFsbG93ZWRUeXBlcykge1xuICBpZiAoYWxsb3dlZFR5cGVzLmluZGV4T2YodHlwZSkgPT09IC0xKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihlcnJvck1lc3NhZ2VGb3IodHlwZSwgYWxsb3dlZFR5cGVzKSk7XG4gIH1cbn1cblxuZnVuY3Rpb24gZXJyb3JNZXNzYWdlRm9yKHR5cGUsIGFsbG93ZWRUeXBlcykge1xuICB2YXIgbWVzc2FnZSA9ICdVbmtub3duIGV2ZW50IHR5cGUgXCInICsgdHlwZSArICdcIi4gJztcbiAgaWYgKF9fREVWX18pIHtcbiAgICBtZXNzYWdlICs9IHJlY29tbWVuZGF0aW9uRm9yKHR5cGUsIGFsbG93ZWRUeXBlcyk7XG4gIH1cbiAgbWVzc2FnZSArPSAnS25vd24gZXZlbnQgdHlwZXM6ICcgKyBhbGxvd2VkVHlwZXMuam9pbignLCAnKSArICcuJztcbiAgcmV0dXJuIG1lc3NhZ2U7XG59XG5cbi8vIEFsbG93IGZvciBnb29kIGVycm9yIG1lc3NhZ2VzXG5pZiAoX19ERVZfXykge1xuICB2YXIgcmVjb21tZW5kYXRpb25Gb3IgPSBmdW5jdGlvbih0eXBlLCBhbGxvd2VkVHlwZXMpIHtcbiAgICB2YXIgY2xvc2VzdFR5cGVSZWNvbW1lbmRhdGlvbiA9IGNsb3Nlc3RUeXBlRm9yKHR5cGUsIGFsbG93ZWRUeXBlcyk7XG4gICAgaWYgKGlzQ2xvc2VFbm91Z2goY2xvc2VzdFR5cGVSZWNvbW1lbmRhdGlvbiwgdHlwZSkpIHtcbiAgICAgIHJldHVybiAnRGlkIHlvdSBtZWFuIFwiJyArIGNsb3Nlc3RUeXBlUmVjb21tZW5kYXRpb24udHlwZSArICdcIj8gJztcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuICcnO1xuICAgIH1cbiAgfTtcblxuICB2YXIgY2xvc2VzdFR5cGVGb3IgPSBmdW5jdGlvbih0eXBlLCBhbGxvd2VkVHlwZXMpIHtcbiAgICB2YXIgdHlwZVJlY29tbWVuZGF0aW9ucyA9IGFsbG93ZWRUeXBlcy5tYXAoXG4gICAgICB0eXBlUmVjb21tZW5kYXRpb25Gb3IuYmluZCh0aGlzLCB0eXBlKVxuICAgICk7XG4gICAgcmV0dXJuIHR5cGVSZWNvbW1lbmRhdGlvbnMuc29ydChyZWNvbW1lbmRhdGlvblNvcnQpWzBdO1xuICB9O1xuXG4gIHZhciB0eXBlUmVjb21tZW5kYXRpb25Gb3IgPSBmdW5jdGlvbih0eXBlLCByZWNvbWVuZGVkVHlwZSkge1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiByZWNvbWVuZGVkVHlwZSxcbiAgICAgIGRpc3RhbmNlOiBkYW1lcmF1TGV2ZW5zaHRlaW5EaXN0YW5jZSh0eXBlLCByZWNvbWVuZGVkVHlwZSlcbiAgICB9O1xuICB9O1xuXG4gIHZhciByZWNvbW1lbmRhdGlvblNvcnQgPSBmdW5jdGlvbihyZWNvbW1lbmRhdGlvbkEsIHJlY29tbWVuZGF0aW9uQikge1xuICAgIGlmIChyZWNvbW1lbmRhdGlvbkEuZGlzdGFuY2UgPCByZWNvbW1lbmRhdGlvbkIuZGlzdGFuY2UpIHtcbiAgICAgIHJldHVybiAtMTtcbiAgICB9IGVsc2UgaWYgKHJlY29tbWVuZGF0aW9uQS5kaXN0YW5jZSA+IHJlY29tbWVuZGF0aW9uQi5kaXN0YW5jZSkge1xuICAgICAgcmV0dXJuIDE7XG4gICAgfSBlbHNlIHtcbiAgICAgIHJldHVybiAwO1xuICAgIH1cbiAgfTtcblxuICB2YXIgaXNDbG9zZUVub3VnaCA9IGZ1bmN0aW9uKGNsb3Nlc3RUeXBlLCBhY3R1YWxUeXBlKSB7XG4gICAgcmV0dXJuIChjbG9zZXN0VHlwZS5kaXN0YW5jZSAvIGFjdHVhbFR5cGUubGVuZ3RoKSA8IDAuMzM0O1xuICB9O1xuXG4gIHZhciBkYW1lcmF1TGV2ZW5zaHRlaW5EaXN0YW5jZSA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICB2YXIgaSwgajtcbiAgICB2YXIgZCA9IFtdO1xuXG4gICAgZm9yIChpID0gMDsgaSA8PSBhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBkW2ldID0gW2ldO1xuICAgIH1cblxuICAgIGZvciAoaiA9IDE7IGogPD0gYi5sZW5ndGg7IGorKykge1xuICAgICAgZFswXVtqXSA9IGo7XG4gICAgfVxuXG4gICAgZm9yIChpID0gMTsgaSA8PSBhLmxlbmd0aDsgaSsrKSB7XG4gICAgICBmb3IgKGogPSAxOyBqIDw9IGIubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgdmFyIGNvc3QgPSBhLmNoYXJBdChpIC0gMSkgPT09IGIuY2hhckF0KGogLSAxKSA/IDAgOiAxO1xuXG4gICAgICAgIGRbaV1bal0gPSBNYXRoLm1pbihcbiAgICAgICAgICBkW2kgLSAxXVtqXSArIDEsXG4gICAgICAgICAgZFtpXVtqIC0gMV0gKyAxLFxuICAgICAgICAgIGRbaSAtIDFdW2ogLSAxXSArIGNvc3RcbiAgICAgICAgKTtcblxuICAgICAgICBpZiAoaSA+IDEgJiYgaiA+IDEgJiZcbiAgICAgICAgICAgIGEuY2hhckF0KGkgLSAxKSA9PSBiLmNoYXJBdChqIC0gMikgJiZcbiAgICAgICAgICAgIGEuY2hhckF0KGkgLSAyKSA9PSBiLmNoYXJBdChqIC0gMSkpIHtcbiAgICAgICAgICBkW2ldW2pdID0gTWF0aC5taW4oZFtpXVtqXSwgZFtpIC0gMl1baiAtIDJdICsgY29zdCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gZFthLmxlbmd0aF1bYi5sZW5ndGhdO1xuICB9O1xufVxuXG5tb2R1bGUuZXhwb3J0cyA9IEV2ZW50VmFsaWRhdG9yO1xuIl19