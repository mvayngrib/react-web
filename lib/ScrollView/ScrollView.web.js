







'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();

var _react=require('react');var _react2=_interopRequireDefault(_react);
var _reactDom=require('react-dom');var _reactDom2=_interopRequireDefault(_reactDom);
var _ReactScrollResponder=require('../ListView/ScrollResponder.web');var _ReactScrollResponder2=_interopRequireDefault(_ReactScrollResponder);
var _ReactStyleSheet=require('../StyleSheet/StyleSheet.web');var _ReactStyleSheet2=_interopRequireDefault(_ReactStyleSheet);
var _ReactView=require('../View/View.web');var _ReactView2=_interopRequireDefault(_ReactView);
var _throttle=require('domkit/throttle');var _throttle2=_interopRequireDefault(_throttle);
var _reactMixin=require('react-mixin');var _reactMixin2=_interopRequireDefault(_reactMixin);
var _autobindDecorator=require('autobind-decorator');var _autobindDecorator2=_interopRequireDefault(_autobindDecorator);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _objectWithoutProperties(obj,keys){var target={};for(var i in obj){if(keys.indexOf(i)>=0)continue;if(!Object.prototype.hasOwnProperty.call(obj,i))continue;target[i]=obj[i];}return target;}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}

var SCROLLVIEW='ScrollView';
var INNERVIEW='InnerScrollView';
var CONTENT_EXT_STYLE=['padding','paddingTop','paddingBottom','paddingLeft','paddingRight'];var
















ScrollView=function(_Component){_inherits(ScrollView,_Component);function ScrollView(){var _ref;var _temp,_this,_ret;_classCallCheck(this,ScrollView);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=ScrollView.__proto__||Object.getPrototypeOf(ScrollView)).call.apply(_ref,[this].concat(args))),_this),_this.

state=_this.scrollResponderMixinGetInitialState(),_temp),_possibleConstructorReturn(_this,_ret);}_createClass(ScrollView,[{key:'getScrollResponder',value:function getScrollResponder()







{
return this;
}},{key:'getInnerViewNode',value:function getInnerViewNode()

{
return this.refs[INNERVIEW];
}},{key:'scrollTo',value:function scrollTo(

opts){


if(typeof opts==='number'){
opts={y:opts,x:arguments[1]};
}

this.scrollWithoutAnimationTo(opts.y,opts.x);
}},{key:'scrollWithoutAnimationTo',value:function scrollWithoutAnimationTo(

destY,destX){






var scrollView=_reactDom2.default.findDOMNode(this.refs[SCROLLVIEW]);
scrollView.scrollTop=destY||0;
scrollView.scrollLeft=destX||0;
}},{key:'handleScroll',value:function handleScroll(

e){

















this.props.onScroll&&this.props.onScroll(e);
}},{key:'render',value:function render()

{var _props=



this.props;var style=_props.style;var otherProps=_objectWithoutProperties(_props,['style']);

var contentContainerExtStyle={};

if(style){
for(var i=0;i<CONTENT_EXT_STYLE.length;i++){
if(typeof style[CONTENT_EXT_STYLE[i]]==='number'){
contentContainerExtStyle[CONTENT_EXT_STYLE[i]]=style[CONTENT_EXT_STYLE[i]];
}
}
}

var contentContainerStyle=[
styles.contentContainer,
this.props.horizontal&&styles.contentContainerHorizontal,
this.props.contentContainerStyle,
contentContainerExtStyle];












var contentContainer=
_react2.default.createElement(_ReactView2.default,{
ref:INNERVIEW,
style:contentContainerStyle,
removeClippedSubviews:this.props.removeClippedSubviews,
collapsable:false},
this.props.children);


var alwaysBounceHorizontal=
this.props.alwaysBounceHorizontal!==undefined?
this.props.alwaysBounceHorizontal:
this.props.horizontal;

var alwaysBounceVertical=
this.props.alwaysBounceVertical!==undefined?
this.props.alwaysBounceVertical:
!this.props.horizontal;

var handleScroll=function handleScroll(){};
if(this.props.scrollEventThrottle&&this.props.onScroll){
handleScroll=(0,_throttle2.default)(this.handleScroll,this.props.scrollEventThrottle);
}

var props=_extends({},
otherProps,{
alwaysBounceHorizontal:alwaysBounceHorizontal,
alwaysBounceVertical:alwaysBounceVertical,
style:[styles.base,this.props.style],
onTouchStart:this.scrollResponderHandleTouchStart,
onTouchMove:this.scrollResponderHandleTouchMove,
onTouchEnd:this.scrollResponderHandleTouchEnd,
onScrollBeginDrag:this.scrollResponderHandleScrollBeginDrag,
onScrollEndDrag:this.scrollResponderHandleScrollEndDrag,
onMomentumScrollBegin:this.scrollResponderHandleMomentumScrollBegin,
onMomentumScrollEnd:this.scrollResponderHandleMomentumScrollEnd,
onStartShouldSetResponder:this.scrollResponderHandleStartShouldSetResponder,
onStartShouldSetResponderCapture:this.scrollResponderHandleStartShouldSetResponderCapture,


onScrollShouldSetResponder:handleScroll,

onScroll:function onScroll(){},
onResponderGrant:this.scrollResponderHandleResponderGrant,
onResponderTerminationRequest:this.scrollResponderHandleTerminationRequest,
onResponderTerminate:this.scrollResponderHandleTerminate,
onResponderRelease:this.scrollResponderHandleResponderRelease,
onResponderReject:this.scrollResponderHandleResponderReject});


return(
_react2.default.createElement(_ReactView2.default,_extends({},props,{ref:SCROLLVIEW}),
contentContainer));


}}]);return ScrollView;}(_react.Component);
;

var styles=_ReactStyleSheet2.default.create({
base:{
overflow:'scroll',
WebkitOverflowScrolling:'touch',
flex:1},

contentContainer:{
position:'absolute',
minWidth:'100%'},

contentContainerHorizontal:{
alignSelf:'flex-start',
flexDirection:'row'}});



_reactMixin2.default.onClass(ScrollView,_ReactScrollResponder2.default.Mixin);
(0,_autobindDecorator2.default)(ScrollView);

ScrollView.isReactNativeComponent=true;exports.default=

ScrollView;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlNjcm9sbFZpZXcud2ViLmpzIl0sIm5hbWVzIjpbIlNDUk9MTFZJRVciLCJJTk5FUlZJRVciLCJDT05URU5UX0VYVF9TVFlMRSIsIlNjcm9sbFZpZXciLCJzdGF0ZSIsInNjcm9sbFJlc3BvbmRlck1peGluR2V0SW5pdGlhbFN0YXRlIiwicmVmcyIsIm9wdHMiLCJ5IiwieCIsImFyZ3VtZW50cyIsInNjcm9sbFdpdGhvdXRBbmltYXRpb25UbyIsImRlc3RZIiwiZGVzdFgiLCJzY3JvbGxWaWV3IiwiZmluZERPTU5vZGUiLCJzY3JvbGxUb3AiLCJzY3JvbGxMZWZ0IiwiZSIsInByb3BzIiwib25TY3JvbGwiLCJzdHlsZSIsIm90aGVyUHJvcHMiLCJjb250ZW50Q29udGFpbmVyRXh0U3R5bGUiLCJpIiwibGVuZ3RoIiwiY29udGVudENvbnRhaW5lclN0eWxlIiwic3R5bGVzIiwiY29udGVudENvbnRhaW5lciIsImhvcml6b250YWwiLCJjb250ZW50Q29udGFpbmVySG9yaXpvbnRhbCIsInJlbW92ZUNsaXBwZWRTdWJ2aWV3cyIsImNoaWxkcmVuIiwiYWx3YXlzQm91bmNlSG9yaXpvbnRhbCIsInVuZGVmaW5lZCIsImFsd2F5c0JvdW5jZVZlcnRpY2FsIiwiaGFuZGxlU2Nyb2xsIiwic2Nyb2xsRXZlbnRUaHJvdHRsZSIsImJhc2UiLCJvblRvdWNoU3RhcnQiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVUb3VjaFN0YXJ0Iiwib25Ub3VjaE1vdmUiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVUb3VjaE1vdmUiLCJvblRvdWNoRW5kIiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlVG91Y2hFbmQiLCJvblNjcm9sbEJlZ2luRHJhZyIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbEJlZ2luRHJhZyIsIm9uU2Nyb2xsRW5kRHJhZyIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbEVuZERyYWciLCJvbk1vbWVudHVtU2Nyb2xsQmVnaW4iLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVNb21lbnR1bVNjcm9sbEJlZ2luIiwib25Nb21lbnR1bVNjcm9sbEVuZCIsInNjcm9sbFJlc3BvbmRlckhhbmRsZU1vbWVudHVtU2Nyb2xsRW5kIiwib25TdGFydFNob3VsZFNldFJlc3BvbmRlciIsInNjcm9sbFJlc3BvbmRlckhhbmRsZVN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyIiwib25TdGFydFNob3VsZFNldFJlc3BvbmRlckNhcHR1cmUiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlckNhcHR1cmUiLCJvblNjcm9sbFNob3VsZFNldFJlc3BvbmRlciIsIm9uUmVzcG9uZGVyR3JhbnQiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVSZXNwb25kZXJHcmFudCIsIm9uUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0Iiwic2Nyb2xsUmVzcG9uZGVySGFuZGxlVGVybWluYXRpb25SZXF1ZXN0Iiwib25SZXNwb25kZXJUZXJtaW5hdGUiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVUZXJtaW5hdGUiLCJvblJlc3BvbmRlclJlbGVhc2UiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVSZXNwb25kZXJSZWxlYXNlIiwib25SZXNwb25kZXJSZWplY3QiLCJzY3JvbGxSZXNwb25kZXJIYW5kbGVSZXNwb25kZXJSZWplY3QiLCJjcmVhdGUiLCJvdmVyZmxvdyIsIldlYmtpdE92ZXJmbG93U2Nyb2xsaW5nIiwiZmxleCIsInBvc2l0aW9uIiwibWluV2lkdGgiLCJhbGlnblNlbGYiLCJmbGV4RGlyZWN0aW9uIiwib25DbGFzcyIsIk1peGluIiwiaXNSZWFjdE5hdGl2ZUNvbXBvbmVudCJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFRQSxhOztBQUVBLDRCO0FBQ0EsbUM7QUFDQSxxRTtBQUNBLDZEO0FBQ0EsMkM7QUFDQSx5QztBQUNBLHVDO0FBQ0EscUQ7O0FBRUEsR0FBTUEsWUFBYSxZQUFuQjtBQUNBLEdBQU1DLFdBQVksaUJBQWxCO0FBQ0EsR0FBTUMsbUJBQW9CLENBQUMsU0FB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bnQiOlsiLyoqXG4gKiBDb3B5cmlnaHQgKGMpIDIwMTUtcHJlc2VudCwgQWxpYmFiYSBHcm91cCBIb2xkaW5nIExpbWl0ZWQuXG4gKiBBbGwgcmlnaHRzIHJlc2VydmVkLlxuICpcbiAqIENvcHlyaWdodCAoYykgMjAxNSwgRmFjZWJvb2ssIEluYy4gIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogQHByb3ZpZGVzTW9kdWxlIFJlYWN0U2Nyb2xsVmlld1xuICovXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCBSZWFjdCwgeyBQcm9wVHlwZXMsIENvbXBvbmVudH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0IFJlYWN0RE9NIGZyb20gJ3JlYWN0LWRvbSc7XG5pbXBvcnQgU2Nyb2xsUmVzcG9uZGVyIGZyb20gJ1JlYWN0U2Nyb2xsUmVzcG9uZGVyJztcbmltcG9ydCBTdHlsZVNoZWV0IGZyb20gJ1JlYWN0U3R5bGVTaGVldCc7XG5pbXBvcnQgVmlldyBmcm9tICdSZWFjdFZpZXcnO1xuaW1wb3J0IHRocm90dGxlIGZyb20gJ2RvbWtpdC90aHJvdHRsZSc7XG5pbXBvcnQgbWl4aW4gZnJvbSAncmVhY3QtbWl4aW4nO1xuaW1wb3J0IGF1dG9iaW5kIGZyb20gJ2F1dG9iaW5kLWRlY29yYXRvcic7XG5cbmNvbnN0IFNDUk9MTFZJRVcgPSAnU2Nyb2xsVmlldyc7XG5jb25zdCBJTk5FUlZJRVcgPSAnSW5uZXJTY3JvbGxWaWV3JztcbmNvbnN0IENPTlRFTlRfRVhUX1NUWUxFID0gWydwYWRkaW5nJywgJ3BhZGRpbmdUb3AnLCAncGFkZGluZ0JvdHRvbScsICdwYWRkaW5nTGVmdCcsICdwYWRkaW5nUmlnaHQnXTtcblxuLyoqXG4gKiBDb21wb25lbnQgdGhhdCB3cmFwcyBwbGF0Zm9ybSBTY3JvbGxWaWV3IHdoaWxlIHByb3ZpZGluZ1xuICogaW50ZWdyYXRpb24gd2l0aCB0b3VjaCBsb2NraW5nIFwicmVzcG9uZGVyXCIgc3lzdGVtLlxuICpcbiAqIEtlZXAgaW4gbWluZCB0aGF0IFNjcm9sbFZpZXdzIG11c3QgaGF2ZSBhIGJvdW5kZWQgaGVpZ2h0IGluIG9yZGVyIHRvIHdvcmssXG4gKiBzaW5jZSB0aGV5IGNvbnRhaW4gdW5ib3VuZGVkLWhlaWdodCBjaGlsZHJlbiBpbnRvIGEgYm91bmRlZCBjb250YWluZXIgKHZpYVxuICogYSBzY3JvbGwgaW50ZXJhY3Rpb24pLiBJbiBvcmRlciB0byBib3VuZCB0aGUgaGVpZ2h0IG9mIGEgU2Nyb2xsVmlldywgZWl0aGVyXG4gKiBzZXQgdGhlIGhlaWdodCBvZiB0aGUgdmlldyBkaXJlY3RseSAoZGlzY291cmFnZWQpIG9yIG1ha2Ugc3VyZSBhbGwgcGFyZW50XG4gKiB2aWV3cyBoYXZlIGJvdW5kZWQgaGVpZ2h0LiBGb3JnZXR0aW5nIHRvIHRyYW5zZmVyIGB7ZmxleDogMX1gIGRvd24gdGhlXG4gKiB2aWV3IHN0YWNrIGNhbiBsZWFkIHRvIGVycm9ycyBoZXJlLCB3aGljaCB0aGUgZWxlbWVudCBpbnNwZWN0b3IgbWFrZXNcbiAqIGVhc3kgdG8gZGVidWcuXG4gKlxuICogRG9lc24ndCB5ZXQgc3VwcG9ydCBvdGhlciBjb250YWluZWQgcmVzcG9uZGVycyBmcm9tIGJsb2NraW5nIHRoaXMgc2Nyb2xsXG4gKiB2aWV3IGZyb20gYmVjb21pbmcgdGhlIHJlc3BvbmRlci5cbiAqL1xuY2xhc3MgU2Nyb2xsVmlldyBleHRlbmRzIENvbXBvbmVudCB7XG5cbiAgc3RhdGUgPSB0aGlzLnNjcm9sbFJlc3BvbmRlck1peGluR2V0SW5pdGlhbFN0YXRlKCk7XG5cbiAgLyoqXG4gICAqIFJldHVybnMgYSByZWZlcmVuY2UgdG8gdGhlIHVuZGVybHlpbmcgc2Nyb2xsIHJlc3BvbmRlciwgd2hpY2ggc3VwcG9ydHNcbiAgICogb3BlcmF0aW9ucyBsaWtlIGBzY3JvbGxUb2AuIEFsbCBTY3JvbGxWaWV3LWxpa2UgY29tcG9uZW50cyBzaG91bGRcbiAgICogaW1wbGVtZW50IHRoaXMgbWV0aG9kIHNvIHRoYXQgdGhleSBjYW4gYmUgY29tcG9zZWQgd2hpbGUgcHJvdmlkaW5nIGFjY2Vzc1xuICAgKiB0byB0aGUgdW5kZXJseWluZyBzY3JvbGwgcmVzcG9uZGVyJ3MgbWV0aG9kcy5cbiAgICovXG4gIGdldFNjcm9sbFJlc3BvbmRlcigpIHtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIGdldElubmVyVmlld05vZGUoKSB7XG4gICAgcmV0dXJuIHRoaXMucmVmc1tJTk5FUlZJRVddO1xuICB9XG5cbiAgc2Nyb2xsVG8ob3B0cykge1xuICAgIC8vICRGbG93Rml4TWUgLSBEb24ndCBrbm93IGhvdyB0byBwYXNzIE1peGluIGNvcnJlY3RseS4gUG9zdHBvbmUgZm9yIG5vd1xuICAgIC8vIHRoaXMuZ2V0U2Nyb2xsUmVzcG9uZGVyKCkuc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsVG8oZGVzdFggfHwgMCwgZGVzdFkgfHwgMCk7XG4gICAgaWYgKHR5cGVvZiBvcHRzID09PSAnbnVtYmVyJykge1xuICAgICAgb3B0cyA9IHsgeTogb3B0cywgeDogYXJndW1lbnRzWzFdIH07XG4gICAgfVxuXG4gICAgdGhpcy5zY3JvbGxXaXRob3V0QW5pbWF0aW9uVG8ob3B0cy55LCBvcHRzLngpO1xuICB9XG5cbiAgc2Nyb2xsV2l0aG91dEFuaW1hdGlvblRvKGRlc3RZPzogbnVtYmVyLCBkZXN0WD86IG51bWJlcikge1xuICAgIC8vICRGbG93Rml4TWUgLSBEb24ndCBrbm93IGhvdyB0byBwYXNzIE1peGluIGNvcnJlY3RseS4gUG9zdHBvbmUgZm9yIG5vd1xuICAgIC8vIHRoaXMuZ2V0U2Nyb2xsUmVzcG9uZGVyKCkuc2Nyb2xsUmVzcG9uZGVyU2Nyb2xsV2l0aG91dGhBbmltYXRpb25UbyhcbiAgICAvLyAgIGRlc3RYIHx8IDAsXG4gICAgLy8gICBkZXN0WSB8fCAwLFxuICAgIC8vICk7XG5cbiAgICBsZXQgc2Nyb2xsVmlldyA9IFJlYWN0RE9NLmZpbmRET01Ob2RlKHRoaXMucmVmc1tTQ1JPTExWSUVXXSk7XG4gICAgc2Nyb2xsVmlldy5zY3JvbGxUb3AgPSBkZXN0WSB8fCAwO1xuICAgIHNjcm9sbFZpZXcuc2Nyb2xsTGVmdCA9IGRlc3RYIHx8IDA7XG4gIH1cblxuICBoYW5kbGVTY3JvbGwoZTogRXZlbnQpIHtcbiAgICAvLyBpZiAoX19ERVZfXykge1xuICAgIC8vICAgaWYgKHRoaXMucHJvcHMub25TY3JvbGwgJiYgIXRoaXMucHJvcHMuc2Nyb2xsRXZlbnRUaHJvdHRsZSkge1xuICAgIC8vICAgICBjb25zb2xlLmxvZyhcbiAgICAvLyAgICAgICAnWW91IHNwZWNpZmllZCBgb25TY3JvbGxgIG9uIGEgPFNjcm9sbFZpZXc+IGJ1dCBub3QgJyArXG4gICAgLy8gICAgICAgJ2BzY3JvbGxFdmVudFRocm90dGxlYC4gWW91IHdpbGwgb25seSByZWNlaXZlIG9uZSBldmVudC4gJyArXG4gICAgLy8gICAgICAgJ1VzaW5nIGAxNmAgeW91IGdldCBhbGwgdGhlIGV2ZW50cyBidXQgYmUgYXdhcmUgdGhhdCBpdCBtYXkgJyArXG4gICAgLy8gICAgICAgJ2NhdXNlIGZyYW1lIGRyb3BzLCB1c2UgYSBiaWdnZXIgbnVtYmVyIGlmIHlvdSBkb25cXCd0IG5lZWQgYXMgJyArXG4gICAgLy8gICAgICAgJ211Y2ggcHJlY2lzaW9uLidcbiAgICAvLyAgICAgKTtcbiAgICAvLyAgIH1cbiAgICAvLyB9XG4gICAgLy8gaWYgKFBsYXRmb3JtLk9TID09PSAnYW5kcm9pZCcpIHtcbiAgICAvLyAgIGlmICh0aGlzLnByb3BzLmtleWJvYXJkRGlzbWlzc01vZGUgPT09ICdvbi1kcmFnJykge1xuICAgIC8vICAgICBkaXNtaXNzS2V5Ym9hcmQoKTtcbiAgICAvLyAgIH1cbiAgICAvLyB9XG5cbiAgICB0aGlzLnByb3BzLm9uU2Nyb2xsICYmIHRoaXMucHJvcHMub25TY3JvbGwoZSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgbGV0IHtcbiAgICAgIHN0eWxlLFxuICAgICAgLi4ub3RoZXJQcm9wc1xuICAgIH0gPSB0aGlzLnByb3BzO1xuXG4gICAgbGV0IGNvbnRlbnRDb250YWluZXJFeHRTdHlsZSA9IHt9O1xuXG4gICAgaWYgKHN0eWxlKSB7XG4gICAgICBmb3IgKGxldCBpID0gMDsgaSA8IENPTlRFTlRfRVhUX1NUWUxFLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgIGlmICh0eXBlb2Ygc3R5bGVbQ09OVEVOVF9FWFRfU1RZTEVbaV1dID09PSAnbnVtYmVyJykge1xuICAgICAgICAgIGNvbnRlbnRDb250YWluZXJFeHRTdHlsZVtDT05URU5UX0VYVF9TVFlMRVtpXV0gPSBzdHlsZVtDT05URU5UX0VYVF9TVFlMRVtpXV07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG5cbiAgICBsZXQgY29udGVudENvbnRhaW5lclN0eWxlID0gW1xuICAgICAgc3R5bGVzLmNvbnRlbnRDb250YWluZXIsXG4gICAgICB0aGlzLnByb3BzLmhvcml6b250YWwgJiYgc3R5bGVzLmNvbnRlbnRDb250YWluZXJIb3Jpem9udGFsLFxuICAgICAgdGhpcy5wcm9wcy5jb250ZW50Q29udGFpbmVyU3R5bGUsXG4gICAgICBjb250ZW50Q29udGFpbmVyRXh0U3R5bGUsXG4gICAgXTtcbiAgICAvLyBpZiAoX19ERVZfXyAmJiB0aGlzLnByb3BzLnN0eWxlKSB7XG4gICAgLy8gICBsZXQgc3R5bGUgPSBmbGF0dGVuU3R5bGUodGhpcy5wcm9wcy5zdHlsZSk7XG4gICAgLy8gICBsZXQgY2hpbGRMYXlvdXRQcm9wcyA9IFsnYWxpZ25JdGVtcycsICdqdXN0aWZ5Q29udGVudCddXG4gICAgLy8gICAgIC5maWx0ZXIoKHByb3ApID0+IHN0eWxlICYmIHN0eWxlW3Byb3BdICE9PSB1bmRlZmluZWQpO1xuICAgIC8vICAgaW52YXJpYW50KFxuICAgIC8vICAgICBjaGlsZExheW91dFByb3BzLmxlbmd0aCA9PT0gMCxcbiAgICAvLyAgICAgJ1Njcm9sbFZpZXcgY2hpbGQgbGF5b3V0ICgnICsgSlNPTi5zdHJpbmdpZnkoY2hpbGRMYXlvdXRQcm9wcykgK1xuICAgIC8vICAgICAgICcpIG11c3QgYnkgYXBwbGllZCB0aHJvdWdoIHRoZSBjb250ZW50Q29udGFpbmVyU3R5bGUgcHJvcC4nXG4gICAgLy8gICApO1xuICAgIC8vIH1cblxuICAgIGxldCBjb250ZW50Q29udGFpbmVyID1cbiAgICAgIDxWaWV3XG4gICAgICAgIHJlZj17SU5ORVJWSUVXfVxuICAgICAgICBzdHlsZT17Y29udGVudENvbnRhaW5lclN0eWxlfVxuICAgICAgICByZW1vdmVDbGlwcGVkU3Vidmlld3M9e3RoaXMucHJvcHMucmVtb3ZlQ2xpcHBlZFN1YnZpZXdzfVxuICAgICAgICBjb2xsYXBzYWJsZT17ZmFsc2V9PlxuICAgICAgICB7dGhpcy5wcm9wcy5jaGlsZHJlbn1cbiAgICAgIDwvVmlldz47XG5cbiAgICBsZXQgYWx3YXlzQm91bmNlSG9yaXpvbnRhbCA9XG4gICAgICB0aGlzLnByb3BzLmFsd2F5c0JvdW5jZUhvcml6b250YWwgIT09IHVuZGVmaW5lZCA/XG4gICAgICAgIHRoaXMucHJvcHMuYWx3YXlzQm91bmNlSG9yaXpvbnRhbCA6XG4gICAgICAgIHRoaXMucHJvcHMuaG9yaXpvbnRhbDtcblxuICAgIGxldCBhbHdheXNCb3VuY2VWZXJ0aWNhbCA9XG4gICAgICB0aGlzLnByb3BzLmFsd2F5c0JvdW5jZVZlcnRpY2FsICE9PSB1bmRlZmluZWQgP1xuICAgICAgICB0aGlzLnByb3BzLmFsd2F5c0JvdW5jZVZlcnRpY2FsIDpcbiAgICAgICAgIXRoaXMucHJvcHMuaG9yaXpvbnRhbDtcblxuICAgIGxldCBoYW5kbGVTY3JvbGwgPSAoKSA9PiB7fTtcbiAgICBpZiAodGhpcy5wcm9wcy5zY3JvbGxFdmVudFRocm90dGxlICYmIHRoaXMucHJvcHMub25TY3JvbGwpIHtcbiAgICAgIGhhbmRsZVNjcm9sbCA9IHRocm90dGxlKHRoaXMuaGFuZGxlU2Nyb2xsLCB0aGlzLnByb3BzLnNjcm9sbEV2ZW50VGhyb3R0bGUpO1xuICAgIH1cblxuICAgIGxldCBwcm9wcyA9IHtcbiAgICAgIC4uLm90aGVyUHJvcHMsXG4gICAgICBhbHdheXNCb3VuY2VIb3Jpem9udGFsLFxuICAgICAgYWx3YXlzQm91bmNlVmVydGljYWwsXG4gICAgICBzdHlsZTogKFtzdHlsZXMuYmFzZSwgdGhpcy5wcm9wcy5zdHlsZV06ID9BcnJheTxhbnk+KSxcbiAgICAgIG9uVG91Y2hTdGFydDogdGhpcy5zY3JvbGxSZXNwb25kZXJIYW5kbGVUb3VjaFN0YXJ0LFxuICAgICAgb25Ub3VjaE1vdmU6IHRoaXMuc2Nyb2xsUmVzcG9uZGVySGFuZGxlVG91Y2hNb3ZlLFxuICAgICAgb25Ub3VjaEVuZDogdGhpcy5zY3JvbGxSZXNwb25kZXJIYW5kbGVUb3VjaEVuZCxcbiAgICAgIG9uU2Nyb2xsQmVnaW5EcmFnOiB0aGlzLnNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbEJlZ2luRHJhZyxcbiAgICAgIG9uU2Nyb2xsRW5kRHJhZzogdGhpcy5zY3JvbGxSZXNwb25kZXJIYW5kbGVTY3JvbGxFbmREcmFnLFxuICAgICAgb25Nb21lbnR1bVNjcm9sbEJlZ2luOiB0aGlzLnNjcm9sbFJlc3BvbmRlckhhbmRsZU1vbWVudHVtU2Nyb2xsQmVnaW4sXG4gICAgICBvbk1vbWVudHVtU2Nyb2xsRW5kOiB0aGlzLnNjcm9sbFJlc3BvbmRlckhhbmRsZU1vbWVudHVtU2Nyb2xsRW5kLFxuICAgICAgb25TdGFydFNob3VsZFNldFJlc3BvbmRlcjogdGhpcy5zY3JvbGxSZXNwb25kZXJIYW5kbGVTdGFydFNob3VsZFNldFJlc3BvbmRlcixcbiAgICAgIG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXJDYXB0dXJlOiB0aGlzLnNjcm9sbFJlc3BvbmRlckhhbmRsZVN0YXJ0U2hvdWxkU2V0UmVzcG9uZGVyQ2FwdHVyZSxcbiAgICAgIC8vIG9uU2Nyb2xsU2hvdWxkU2V0UmVzcG9uZGVyOiB0aGlzLnNjcm9sbFJlc3BvbmRlckhhbmRsZVNjcm9sbFNob3VsZFNldFJlc3BvbmRlcixcbiAgICAgIC8vIG9uU2Nyb2xsOiBoYW5kbGVTY3JvbGwsXG4gICAgICBvblNjcm9sbFNob3VsZFNldFJlc3BvbmRlcjogaGFuZGxlU2Nyb2xsLFxuICAgICAgLy8gcmVwbGFjZSBvblNjcm9sbCBpbiB0aGUgcHJvcHNcbiAgICAgIG9uU2Nyb2xsOiAoKSA9PiB7fSxcbiAgICAgIG9uUmVzcG9uZGVyR3JhbnQ6IHRoaXMuc2Nyb2xsUmVzcG9uZGVySGFuZGxlUmVzcG9uZGVyR3JhbnQsXG4gICAgICBvblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdDogdGhpcy5zY3JvbGxSZXNwb25kZXJIYW5kbGVUZXJtaW5hdGlvblJlcXVlc3QsXG4gICAgICBvblJlc3BvbmRlclRlcm1pbmF0ZTogdGhpcy5zY3JvbGxSZXNwb25kZXJIYW5kbGVUZXJtaW5hdGUsXG4gICAgICBvblJlc3BvbmRlclJlbGVhc2U6IHRoaXMuc2Nyb2xsUmVzcG9uZGVySGFuZGxlUmVzcG9uZGVyUmVsZWFzZSxcbiAgICAgIG9uUmVzcG9uZGVyUmVqZWN0OiB0aGlzLnNjcm9sbFJlc3BvbmRlckhhbmRsZVJlc3BvbmRlclJlamVjdCxcbiAgICB9O1xuXG4gICAgcmV0dXJuIChcbiAgICAgIDxWaWV3IHsuLi5wcm9wc30gcmVmPXtTQ1JPTExWSUVXfT5cbiAgICAgICAge2NvbnRlbnRDb250YWluZXJ9XG4gICAgICA8L1ZpZXc+XG4gICAgKTtcbiAgfVxufTtcblxubGV0IHN0eWxlcyA9IFN0eWxlU2hlZXQuY3JlYXRlKHtcbiAgYmFzZToge1xuICAgIG92ZXJmbG93OiAnc2Nyb2xsJyxcbiAgICBXZWJraXRPdmVyZmxvd1Njcm9sbGluZzogJ3RvdWNoJyxcbiAgICBmbGV4OiAxLFxuICB9LFxuICBjb250ZW50Q29udGFpbmVyOiB7XG4gICAgcG9zaXRpb246ICdhYnNvbHV0ZScsXG4gICAgbWluV2lkdGg6ICcxMDAlJyxcbiAgfSxcbiAgY29udGVudENvbnRhaW5lckhvcml6b250YWw6IHtcbiAgICBhbGlnblNlbGY6ICdmbGV4LXN0YXJ0JyxcbiAgICBmbGV4RGlyZWN0aW9uOiAncm93JyxcbiAgfSxcbn0pO1xuXG5taXhpbi5vbkNsYXNzKFNjcm9sbFZpZXcsIFNjcm9sbFJlc3BvbmRlci5NaXhpbik7XG5hdXRvYmluZChTY3JvbGxWaWV3KTtcblxuU2Nyb2xsVmlldy5pc1JlYWN0TmF0aXZlQ29tcG9uZW50ID0gdHJ1ZTtcblxuZXhwb3J0IGRlZmF1bHQgU2Nyb2xsVmlldztcbiJdfQ==