






'use strict';Object.defineProperty(exports,"__esModule",{value:true});var _extends=Object.assign||function(target){for(var i=1;i<arguments.length;i++){var source=arguments[i];for(var key in source){if(Object.prototype.hasOwnProperty.call(source,key)){target[key]=source[key];}}}return target;};var _createClass=function(){function defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||false;descriptor.configurable=true;if("value"in descriptor)descriptor.writable=true;Object.defineProperty(target,descriptor.key,descriptor);}}return function(Constructor,protoProps,staticProps){if(protoProps)defineProperties(Constructor.prototype,protoProps);if(staticProps)defineProperties(Constructor,staticProps);return Constructor;};}();

var _react=require('react');var _react2=_interopRequireDefault(_react);
var _objectAssign=require('object-assign');var _objectAssign2=_interopRequireDefault(_objectAssign);
var _ReactView=require('../View/View.web');var _ReactView2=_interopRequireDefault(_ReactView);
var _ReactAnimated=require('../Animated/Animated.web');var _ReactAnimated2=_interopRequireDefault(_ReactAnimated);
var _ReactDimensions=require('../Dimensions/Dimensions.web');var _ReactDimensions2=_interopRequireDefault(_ReactDimensions);
var _ReactPanResponder=require('../PanResponder/PanResponder.web');var _ReactPanResponder2=_interopRequireDefault(_ReactPanResponder);
var _ReactDismissKeyboard=require('../Utilties/dismissKeyboard.web');var _ReactDismissKeyboard2=_interopRequireDefault(_ReactDismissKeyboard);
var _NativeMethodsMixin=require('../Utilties/NativeMethodsMixin.web');
var _reactMixin=require('react-mixin');var _reactMixin2=_interopRequireDefault(_reactMixin);
var _autobindDecorator=require('autobind-decorator');var _autobindDecorator2=_interopRequireDefault(_autobindDecorator);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor)){throw new TypeError("Cannot call a class as a function");}}function _possibleConstructorReturn(self,call){if(!self){throw new ReferenceError("this hasn't been initialised - super() hasn't been called");}return call&&(typeof call==="object"||typeof call==="function")?call:self;}function _inherits(subClass,superClass){if(typeof superClass!=="function"&&superClass!==null){throw new TypeError("Super expression must either be null or a function, not "+typeof superClass);}subClass.prototype=Object.create(superClass&&superClass.prototype,{constructor:{value:subClass,enumerable:false,writable:true,configurable:true}});if(superClass)Object.setPrototypeOf?Object.setPrototypeOf(subClass,superClass):subClass.__proto__=superClass;}

var deviceSize=_ReactDimensions2.default.get('window');
var VIEWPAGER_REF='viewpager';var

ViewPager=function(_React$Component){_inherits(ViewPager,_React$Component);function ViewPager(){var _ref;var _temp,_this,_ret;_classCallCheck(this,ViewPager);for(var _len=arguments.length,args=Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}return _ret=(_temp=(_this=_possibleConstructorReturn(this,(_ref=ViewPager.__proto__||Object.getPrototypeOf(ViewPager)).call.apply(_ref,[this].concat(args))),_this),_this.










































state={
selectedPage:_this.props.initialPage,
pageWidth:deviceSize.width,
pageCount:[].concat(_this.props.children).length,
offsetLeft:new _ReactAnimated2.default.Value(0)},_temp),_possibleConstructorReturn(_this,_ret);}_createClass(ViewPager,[{key:'getInnerViewNode',value:function getInnerViewNode()


{
return this.refs[VIEWPAGER_REF].childNodes[0];
}},{key:'componentWillMount',value:function componentWillMount()

{












this._panResponder=_ReactPanResponder2.default.create({
onStartShouldSetResponder:function onStartShouldSetResponder(){return true;},
onMoveShouldSetPanResponder:this._shouldSetPanResponder,
onPanResponderGrant:function onPanResponderGrant(){},
onPanResponderMove:this._panResponderMove,
onPanResponderTerminationRequest:function onPanResponderTerminationRequest(){return true;},
onPanResponderRelease:this._panResponderRelease,
onPanResponderTerminate:function onPanResponderTerminate(){}});

}},{key:'componentDidMount',value:function componentDidMount()

{
this.setPage(this.state.selectedPage);
}},{key:'_childrenWithOverridenStyle',value:function _childrenWithOverridenStyle()

{



return _react2.default.Children.map(this.props.children,function(child){
var style=(0,_objectAssign2.default)({},child.props.style,{width:deviceSize.width});
var newProps={
style:style,
collapsable:false};

return(0,_react.cloneElement)(child,(0,_objectAssign2.default)({},child.props,newProps));
});
}},{key:'render',value:function render()

{
var children=this._childrenWithOverridenStyle();var _state=

this.state;var offsetLeft=_state.offsetLeft;var pageWidth=_state.pageWidth;var pageCount=_state.pageCount;
var width=pageWidth*pageCount;
var count=pageCount-1;

var translateX=offsetLeft.interpolate({
inputRange:[0,count],
outputRange:[0,-(pageWidth*count)],
extrapolate:'clamp'});


return _react2.default.createElement(_ReactView2.default,_extends({ref:VIEWPAGER_REF,
style:this.props.style},
this._panResponder.panHandlers),

_react2.default.createElement(_ReactAnimated2.default.View,{style:{
width:width,
position:'absolute',
top:0,
left:translateX,
bottom:0,
flexDirection:'row'}},

children));


}},{key:'_onPageScroll',value:function _onPageScroll(

event){
if(this.props.onPageScroll){
this.props.onPageScroll(event);
}
if(this.props.keyboardDismissMode==='on-drag'){
(0,_ReactDismissKeyboard2.default)();
}
}},{key:'_shouldSetPanResponder',value:function _shouldSetPanResponder()

{var _this2=this;
if(this._scrolling){
this.state.offsetLeft.stopAnimation(function(){
_this2._scrolling=false;
});
return false;
}

return true;
}},{key:'_panResponderMove',value:function _panResponderMove(

ev,_ref2){var dx=_ref2.dx;
var val=this.state.selectedPage+dx/this.state.pageWidth*-1;
this.state.offsetLeft.setValue(val);
}},{key:'_panResponderRelease',value:function _panResponderRelease(

ev,_ref3){var dx=_ref3.dx;var _state2=
this.state;var selectedPage=_state2.selectedPage;var pageWidth=_state2.pageWidth;
var range=Math.abs(dx)/pageWidth;
var threshold=1/5;

if(range>threshold){
if(dx>0){
selectedPage-=1;
}else{
selectedPage+=1;
}
}

this.setPage(selectedPage);
}},{key:'setPage',value:function setPage(

index){var _this3=this;
if(index<0){
index=0;
}else if(index>=this.state.pageCount){
index=this.state.pageCount-1;
}

this._scrolling=true;

_ReactAnimated2.default.spring(this.state.offsetLeft,{
toValue:index,
bounciness:0,
restSpeedThreshold:1}).
start(function(){

_this3._onPageScroll({
nativeEvent:{
position:index,
offset:0}});



_this3._scrolling=false;

_this3.setState({
selectedPage:index},
function(){
_this3.props.onPageSelected&&_this3.props.onPageSelected({nativeEvent:{position:index}});
});
});
}}]);return ViewPager;}(_react2.default.Component);ViewPager.propTypes={initialPage:_react.PropTypes.number,onPageScroll:_react.PropTypes.func,onPageSelected:_react.PropTypes.func,keyboardDismissMode:_react.PropTypes.oneOf(['none','on-drag'])};ViewPager.defaultProps={initialPage:0};

;

_reactMixin2.default.onClass(ViewPager,_NativeMethodsMixin.Mixin);
(0,_autobindDecorator2.default)(ViewPager);

ViewPager.isReactNativeComponent=true;exports.default=

ViewPager;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIlZpZXdQYWdlci53ZWIuanMiXSwibmFtZXMiOlsiZGV2aWNlU2l6ZSIsImdldCIsIlZJRVdQQUdFUl9SRUYiLCJWaWV3UGFnZXIiLCJzdGF0ZSIsInNlbGVjdGVkUGFnZSIsInByb3BzIiwiaW5pdGlhbFBhZ2UiLCJwYWdlV2lkdGgiLCJ3aWR0aCIsInBhZ2VDb3VudCIsImNvbmNhdCIsImNoaWxkcmVuIiwibGVuZ3RoIiwib2Zmc2V0TGVmdCIsIlZhbHVlIiwicmVmcyIsImNoaWxkTm9kZXMiLCJfcGFuUmVzcG9uZGVyIiwiY3JlYXRlIiwib25TdGFydFNob3VsZFNldFJlc3BvbmRlciIsIm9uTW92ZVNob3VsZFNldFBhblJlc3BvbmRlciIsIl9zaG91bGRTZXRQYW5SZXNwb25kZXIiLCJvblBhblJlc3BvbmRlckdyYW50Iiwib25QYW5SZXNwb25kZXJNb3ZlIiwiX3BhblJlc3BvbmRlck1vdmUiLCJvblBhblJlc3BvbmRlclRlcm1pbmF0aW9uUmVxdWVzdCIsIm9uUGFuUmVzcG9uZGVyUmVsZWFzZSIsIl9wYW5SZXNwb25kZXJSZWxlYXNlIiwib25QYW5SZXNwb25kZXJUZXJtaW5hdGUiLCJzZXRQYWdlIiwiQ2hpbGRyZW4iLCJtYXAiLCJjaGlsZCIsInN0eWxlIiwibmV3UHJvcHMiLCJjb2xsYXBzYWJsZSIsIl9jaGlsZHJlbldpdGhPdmVycmlkZW5TdHlsZSIsImNvdW50IiwidHJhbnNsYXRlWCIsImludGVycG9sYXRlIiwiaW5wdXRSYW5nZSIsIm91dHB1dFJhbmdlIiwiZXh0cmFwb2xhdGUiLCJwYW5IYW5kbGVycyIsInBvc2l0aW9uIiwidG9wIiwibGVmdCIsImJvdHRvbSIsImZsZXhEaXJlY3Rpb24iLCJldmVudCIsIm9uUGFnZVNjcm9sbCIsImtleWJvYXJkRGlzbWlzc01vZGUiLCJfc2Nyb2xsaW5nIiwic3RvcEFuaW1hdGlvbiIsImV2IiwiZHgiLCJ2YWwiLCJzZXRWYWx1ZSIsInJhbmdlIiwiTWF0aCIsImFicyIsInRocmVzaG9sZCIsImluZGV4Iiwic3ByaW5nIiwidG9WYWx1ZSIsImJvdW5jaW5lc3MiLCJyZXN0U3BlZWRUaHJlc2hvbGQiLCJzdGFydCIsIl9vblBhZ2VTY3JvbGwiLCJuYXRpdmVFdmVudCIsIm9mZnNldCIsInNldFN0YXRlIiwib25QYWdlU2VsZWN0ZWQiLCJDb21wb25lbnQiLCJwcm9wVHlwZXMiLCJudW1iZXIiLCJmdW5jIiwib25lT2YiLCJkZWZhdWx0UHJvcHMiLCJvbkNsYXNzIiwiaXNSZWFjdE5hdGl2ZUNvbXBvbmVudCJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQU9BLGE7O0FBRUEsNEI7QUFDQSwyQztBQUNBLDJDO0FBQ0EsdUQ7QUFDQSw2RDtBQUNBLG1FO0FBQ0EscUU7QUFDQTtBQUNBLHVDO0FBQ0EscUQ7O0FBRUEsR0FBTUEsWUFBYSwwQkFBV0MsR0FBWCxDQUFlLFFBQWYsQ0FBbkI7QUFDQSxHQUFNQyxlQUFnQixXQUF0QixDOztBQUVNQyxTOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBMkNKQyxLLENBQVE7QUFDTkMsYUFBYyxNQUFLQyxLQUFMLENBQVdDLFdBRG5CO0FBRU5DLFVBQVdSLFdBQVdTLEtBRmhCO0FBR05DLFVBQVcsR0FBR0MsTUFBSCxDQUFVLE1BQUtMLEtBQUwsQ0FBV00sUUFBckIsRUFBK0JDLE1BSHBDO0FBSU5DLFdBQVksR0FBSSx5QkFBU0MsS0FBYixDQUFtQixDQUFuQixDQUpOLEM7OztBQU9XO0FBQ2pCLE1BQU8sTUFBS0MsSUFBTCxDQUFVZCxhQUFWLEVBQXlCZSxVQUF6QixDQUFvQyxDQUFwQyxDQUFQO0FBQ0QsQzs7QUFFb0I7Ozs7Ozs7Ozs7Ozs7QUFhbkIsS0FBS0MsYUFBTCxDQUFxQiw0QkFBYUMsTUFBYixDQUFvQjtBQUN2Q0MsMEJBQTJCLDJDQUFNLEtBQU4sRUFEWTtBQUV2Q0MsNEJBQTZCLEtBQUtDLHNCQUZLO0FBR3ZDQyxvQkFBcUIsOEJBQU0sQ0FBRyxDQUhTO0FBSXZDQyxtQkFBb0IsS0FBS0MsaUJBSmM7QUFLdkNDLGlDQUFr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QVksQ0FLakJwRSxZQUFhLGlCQUFVcUUsTUFMTixDQWdCakJ6QixhQUFjLGlCQUFVMEIsSUFoQlAsQ0F3QmpCSixlQUFnQixpQkFBVUksSUF4QlQsQ0ErQmpCekIsb0JBQXFCLGlCQUFVMEIsS0FBVixDQUFnQixDQUNuQyxNQURtQyxDQUVuQyxTQUZtQyxDQUFoQixDQS9CSixDLENBRmYzRSxTLENBdUNHNEUsWSxDQUFlLENBQ3BCeEUsWUFBYSxDQURPLEM7O0FBZ0t2Qjs7QUFFRCxxQkFBTXlFLE9BQU4sQ0FBYzdFLFNBQWQ7QUFDQSxnQ0FBU0EsU0FBVDs7QUFFQUEsVUFBVThFLHNCQUFWLENBQW1DLElBQW5DLEM7O0FBRWU5RSxTIiwiZmlsZSI6IlZpZXdQYWdlci53ZWIuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENvcHlyaWdodCAoYykgMjAxNS1wcmVzZW50LCBBbGliYWJhIEdyb3VwIEhvbGRpbmcgTGltaXRlZC5cbiAqIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKlxuICogQHByb3ZpZGVzTW9kdWxlIFJlYWN0Vmlld1BhZ2VyXG4gKlxuICovXG4ndXNlIHN0cmljdCc7XG5cbmltcG9ydCBSZWFjdCwgeyBQcm9wVHlwZXMsIGNsb25lRWxlbWVudCB9IGZyb20gJ3JlYWN0JztcbmltcG9ydCBhc3NpZ24gZnJvbSAnb2JqZWN0LWFzc2lnbic7XG5pbXBvcnQgVmlldyBmcm9tICdSZWFjdFZpZXcnO1xuaW1wb3J0IEFuaW1hdGVkIGZyb20gJ1JlYWN0QW5pbWF0ZWQnO1xuaW1wb3J0IERpbWVuc2lvbnMgZnJvbSAnUmVhY3REaW1lbnNpb25zJztcbmltcG9ydCBQYW5SZXNwb25kZXIgZnJvbSAnUmVhY3RQYW5SZXNwb25kZXInO1xuaW1wb3J0IGRpc21pc3NLZXlib2FyZCBmcm9tICdSZWFjdERpc21pc3NLZXlib2FyZCc7XG5pbXBvcnQgeyBNaXhpbiBhcyBOYXRpdmVNZXRob2RzTWl4aW4gfSBmcm9tICdOYXRpdmVNZXRob2RzTWl4aW4nO1xuaW1wb3J0IG1peGluIGZyb20gJ3JlYWN0LW1peGluJztcbmltcG9ydCBhdXRvYmluZCBmcm9tICdhdXRvYmluZC1kZWNvcmF0b3InO1xuXG5jb25zdCBkZXZpY2VTaXplID0gRGltZW5zaW9ucy5nZXQoJ3dpbmRvdycpO1xuY29uc3QgVklFV1BBR0VSX1JFRiA9ICd2aWV3cGFnZXInO1xuXG5jbGFzcyBWaWV3UGFnZXIgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuXG4gIHN0YXRpYyBwcm9wVHlwZXMgPSB7XG4gICAgLyoqXG4gICAgICogSW5kZXggb2YgaW5pdGlhbCBwYWdlIHRoYXQgc2hvdWxkIGJlIHNlbGVjdGVkLiBVc2UgYHNldFBhZ2VgIG1ldGhvZCB0b1xuICAgICAqIHVwZGF0ZSB0aGUgcGFnZSwgYW5kIGBvblBhZ2VTZWxlY3RlZGAgdG8gbW9uaXRvciBwYWdlIGNoYW5nZXNcbiAgICAgKi9cbiAgICBpbml0aWFsUGFnZTogUHJvcFR5cGVzLm51bWJlcixcblxuICAgIC8qKlxuICAgICAqIEV4ZWN1dGVkIHdoZW4gdHJhbnNpdGlvbmluZyBiZXR3ZWVuIHBhZ2VzIChldGhlciBiZWNhdXNlIG9mIGFuaW1hdGlvbiBmb3JcbiAgICAgKiB0aGUgcmVxdWVzdGVkIHBhZ2UgY2hhbmdlIG9yIHdoZW4gdXNlciBpcyBzd2lwaW5nL2RyYWdnaW5nIGJldHdlZW4gcGFnZXMpXG4gICAgICogVGhlIGBldmVudC5uYXRpdmVFdmVudGAgb2JqZWN0IGZvciB0aGlzIGNhbGxiYWNrIHdpbGwgY2FycnkgZm9sbG93aW5nIGRhdGE6XG4gICAgICogIC0gcG9zaXRpb24gLSBpbmRleCBvZiBmaXJzdCBwYWdlIGZyb20gdGhlIGxlZnQgdGhhdCBpcyBjdXJyZW50bHkgdmlzaWJsZVxuICAgICAqICAtIG9mZnNldCAtIHZhbHVlIGZyb20gcmFuZ2UgWzAsMSkgZGVzY3JpYmluZyBzdGFnZSBiZXR3ZWVuIHBhZ2UgdHJhbnNpdGlvbnMuXG4gICAgICogICAgVmFsdWUgeCBtZWFucyB0aGF0ICgxIC0geCkgZnJhY3Rpb24gb2YgdGhlIHBhZ2UgYXQgXCJwb3NpdGlvblwiIGluZGV4IGlzXG4gICAgICogICAgdmlzaWJsZSwgYW5kIHggZnJhY3Rpb24gb2YgdGhlIG5leHQgcGFnZSBpcyB2aXNpYmxlLlxuICAgICAqL1xuICAgIG9uUGFnZVNjcm9sbDogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgICAvKipcbiAgICAgKiBUaGlzIGNhbGxiYWNrIHdpbGwgYmUgY2FsZWxkIG9uY2UgVmlld1BhZ2VyIGZpbmlzaCBuYXZpZ2F0aW5nIHRvIHNlbGVjdGVkIHBhZ2VcbiAgICAgKiAod2hlbiB1c2VyIHN3aXBlcyBiZXR3ZWVuIHBhZ2VzKS4gVGhlIGBldmVudC5uYXRpdmVFdmVudGAgb2JqZWN0IHBhc3NlZCB0byB0aGlzXG4gICAgICogY2FsbGJhY2sgd2lsbCBoYXZlIGZvbGxvd2luZyBmaWVsZHM6XG4gICAgICogIC0gcG9zaXRpb24gLSBpbmRleCBvZiBwYWdlIHRoYXQgaGFzIGJlZW4gc2VsZWN0ZWRcbiAgICAgKi9cbiAgICBvblBhZ2VTZWxlY3RlZDogUHJvcFR5cGVzLmZ1bmMsXG5cbiAgICAvKipcbiAgICAgKiBEZXRlcm1pbmVzIHdoZXRoZXIgdGhlIGtleWJvYXJkIGdldHMgZGlzbWlzc2VkIGluIHJlc3BvbnNlIHRvIGEgZHJhZy5cbiAgICAgKiAgIC0gJ25vbmUnICh0aGUgZGVmYXVsdCksIGRyYWdzIGRvIG5vdCBkaXNtaXNzIHRoZSBrZXlib2FyZC5cbiAgICAgKiAgIC0gJ29uLWRyYWcnLCB0aGUga2V5Ym9hcmQgaXMgZGlzbWlzc2VkIHdoZW4gYSBkcmFnIGJlZ2lucy5cbiAgICAgKi9cbiAgICBrZXlib2FyZERpc21pc3NNb2RlOiBQcm9wVHlwZXMub25lT2YoW1xuICAgICAgJ25vbmUnLCAvLyBkZWZhdWx0XG4gICAgICAnb24tZHJhZydcbiAgICBdKVxuICB9XG5cbiAgc3RhdGljIGRlZmF1bHRQcm9wcyA9IHtcbiAgICBpbml0aWFsUGFnZTogMFxuICB9XG5cbiAgc3RhdGUgPSB7XG4gICAgc2VsZWN0ZWRQYWdlOiB0aGlzLnByb3BzLmluaXRpYWxQYWdlLFxuICAgIHBhZ2VXaWR0aDogZGV2aWNlU2l6ZS53aWR0aCxcbiAgICBwYWdlQ291bnQ6IFtdLmNvbmNhdCh0aGlzLnByb3BzLmNoaWxkcmVuKS5sZW5ndGgsXG4gICAgb2Zmc2V0TGVmdDogbmV3IEFuaW1hdGVkLlZhbHVlKDApXG4gIH1cblxuICBnZXRJbm5lclZpZXdOb2RlKCkge1xuICAgIHJldHVybiB0aGlzLnJlZnNbVklFV1BBR0VSX1JFRl0uY2hpbGROb2Rlc1swXTtcbiAgfVxuXG4gIGNvbXBvbmVudFdpbGxNb3VudCgpIHtcbiAgICAvLyBsZXQgeyBvZmZzZXRMZWZ0LCBzZWxlY3RlZFBhZ2UgfSA9IHRoaXMuc3RhdGU7XG5cbiAgICAvLyBvZmZzZXRMZWZ0LmFkZExpc3RlbmVyKCh7dmFsdWV9KSA9PiB7XG4gICAgICAvLyBiYWQgcGVyZm9ybWFuY2VcbiAgICAgIC8vIHRoaXMuX29uUGFnZVNjcm9sbCh7XG4gICAgICAvLyAgbmF0aXZlRXZlbnQ6IHtcbiAgICAgIC8vICAgIHBvc2l0aW9uOiBzZWxlY3RlZFBhZ2UsXG4gICAgICAvLyAgICBvZmZzZXQ6IHZhbHVlIC0gc2VsZWN0ZWRQYWdlXG4gICAgICAvLyAgfVxuICAgICAgLy8gfSk7XG4gICAgLy8gfSk7XG5cbiAgICB0aGlzLl9wYW5SZXNwb25kZXIgPSBQYW5SZXNwb25kZXIuY3JlYXRlKHtcbiAgICAgIG9uU3RhcnRTaG91bGRTZXRSZXNwb25kZXI6ICgpID0+IHRydWUsXG4gICAgICBvbk1vdmVTaG91bGRTZXRQYW5SZXNwb25kZXI6IHRoaXMuX3Nob3VsZFNldFBhblJlc3BvbmRlcixcbiAgICAgIG9uUGFuUmVzcG9uZGVyR3JhbnQ6ICgpID0+IHsgfSxcbiAgICAgIG9uUGFuUmVzcG9uZGVyTW92ZTogdGhpcy5fcGFuUmVzcG9uZGVyTW92ZSxcbiAgICAgIG9uUGFuUmVzcG9uZGVyVGVybWluYXRpb25SZXF1ZXN0OiAoKSA9PiB0cnVlLFxuICAgICAgb25QYW5SZXNwb25kZXJSZWxlYXNlOiB0aGlzLl9wYW5SZXNwb25kZXJSZWxlYXNlLFxuICAgICAgb25QYW5SZXNwb25kZXJUZXJtaW5hdGU6ICgpID0+IHsgfVxuICAgIH0pO1xuICB9XG5cbiAgY29tcG9uZW50RGlkTW91bnQoKSB7XG4gICAgdGhpcy5zZXRQYWdlKHRoaXMuc3RhdGUuc2VsZWN0ZWRQYWdlKTtcbiAgfVxuXG4gIF9jaGlsZHJlbldpdGhPdmVycmlkZW5TdHlsZSgpIHtcbiAgICAvLyBPdmVycmlkZSBzdHlsZXMgc28gdGhhdCBlYWNoIHBhZ2Ugd2lsbCBmaWxsIHRoZSBwYXJlbnQuIE5hdGl2ZSBjb21wb25lbnRcbiAgICAvLyB3aWxsIGhhbmRsZSBwb3NpdGlvbmluZyBvZiBlbGVtZW50cywgc28gaXQncyBub3QgaW1wb3J0YW50IHRvIG9mZnNldFxuICAgIC8vIHRoZW0gY29ycmVjdGx5LlxuICAgIHJldHVybiBSZWFjdC5DaGlsZHJlbi5tYXAodGhpcy5wcm9wcy5jaGlsZHJlbiwgZnVuY3Rpb24oY2hpbGQpIHtcbiAgICAgIGxldCBzdHlsZSA9IGFzc2lnbih7fSwgY2hpbGQucHJvcHMuc3R5bGUsIHt3aWR0aDogZGV2aWNlU2l6ZS53aWR0aH0pO1xuICAgICAgbGV0IG5ld1Byb3BzID0ge1xuICAgICAgICBzdHlsZTogc3R5bGUsXG4gICAgICAgIGNvbGxhcHNhYmxlOiBmYWxzZVxuICAgICAgfTtcbiAgICAgIHJldHVybiBjbG9uZUVsZW1lbnQoY2hpbGQsIGFzc2lnbih7fSwgY2hpbGQucHJvcHMsIG5ld1Byb3BzKSk7XG4gICAgfSk7XG4gIH1cblxuICByZW5kZXIoKSB7XG4gICAgbGV0IGNoaWxkcmVuID0gdGhpcy5fY2hpbGRyZW5XaXRoT3ZlcnJpZGVuU3R5bGUoKTtcblxuICAgIGxldCB7IG9mZnNldExlZnQsIHBhZ2VXaWR0aCwgcGFnZUNvdW50IH0gPSB0aGlzLnN0YXRlO1xuICAgIGxldCB3aWR0aCA9IHBhZ2VXaWR0aCAqIHBhZ2VDb3VudDtcbiAgICBsZXQgY291bnQgPSBwYWdlQ291bnQgLSAxO1xuXG4gICAgbGV0IHRyYW5zbGF0ZVggPSBvZmZzZXRMZWZ0LmludGVycG9sYXRlKHtcbiAgICAgIGlucHV0UmFuZ2U6IFswLCBjb3VudF0sXG4gICAgICBvdXRwdXRSYW5nZTogWzAsIC0ocGFnZVdpZHRoICogY291bnQpXSxcbiAgICAgIGV4dHJhcG9sYXRlOiAnY2xhbXAnXG4gICAgfSk7XG5cbiAgICByZXR1cm4gKDxWaWV3IHJlZj17VklFV1BBR0VSX1JFRn1cbiAgICAgIHN0eWxlPXt0aGlzLnByb3BzLnN0eWxlfVxuICAgICAgey4uLnRoaXMuX3BhblJlc3BvbmRlci5wYW5IYW5kbGVyc31cbiAgICA+XG4gICAgICA8QW5pbWF0ZWQuVmlldyBzdHlsZT17e1xuICAgICAgICB3aWR0aDogd2lkdGgsXG4gICAgICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLFxuICAgICAgICB0b3A6IDAsXG4gICAgICAgIGxlZnQ6IHRyYW5zbGF0ZVgsXG4gICAgICAgIGJvdHRvbTogMCxcbiAgICAgICAgZmxleERpcmVjdGlvbjogJ3JvdydcbiAgICAgIH19PlxuICAgICAgICB7Y2hpbGRyZW59XG4gICAgICA8L0FuaW1hdGVkLlZpZXc+XG4gICAgPC9WaWV3Pik7XG4gIH1cblxuICBfb25QYWdlU2Nyb2xsKGV2ZW50KSB7XG4gICAgaWYgKHRoaXMucHJvcHMub25QYWdlU2Nyb2xsKSB7XG4gICAgICB0aGlzLnByb3BzLm9uUGFnZVNjcm9sbChldmVudCk7XG4gICAgfVxuICAgIGlmICh0aGlzLnByb3BzLmtleWJvYXJkRGlzbWlzc01vZGUgPT09ICdvbi1kcmFnJykge1xuICAgICAgZGlzbWlzc0tleWJvYXJkKCk7XG4gICAgfVxuICB9XG5cbiAgX3Nob3VsZFNldFBhblJlc3BvbmRlcigpIHtcbiAgICBpZiAodGhpcy5fc2Nyb2xsaW5nKSB7XG4gICAgICB0aGlzLnN0YXRlLm9mZnNldExlZnQuc3RvcEFuaW1hdGlvbigoKT0+IHtcbiAgICAgICAgdGhpcy5fc2Nyb2xsaW5nID0gZmFsc2U7XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG5cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIF9wYW5SZXNwb25kZXJNb3ZlKGV2LCB7ZHh9KSB7XG4gICAgbGV0IHZhbCA9IHRoaXMuc3RhdGUuc2VsZWN0ZWRQYWdlICsgZHggLyB0aGlzLnN0YXRlLnBhZ2VXaWR0aCAqIC0xO1xuICAgIHRoaXMuc3RhdGUub2Zmc2V0TGVmdC5zZXRWYWx1ZSh2YWwpO1xuICB9XG5cbiAgX3BhblJlc3BvbmRlclJlbGVhc2UoZXYsIHtkeH0pIHtcbiAgICBsZXQgeyBzZWxlY3RlZFBhZ2UsIHBhZ2VXaWR0aCB9ID0gdGhpcy5zdGF0ZTtcbiAgICBsZXQgcmFuZ2UgPSBNYXRoLmFicyhkeCkgLyBwYWdlV2lkdGg7XG4gICAgbGV0IHRocmVzaG9sZCA9IDEgLyA1O1xuXG4gICAgaWYgKHJhbmdlID4gdGhyZXNob2xkKSB7XG4gICAgICBpZiAoZHggPiAwKSB7XG4gICAgICAgIHNlbGVjdGVkUGFnZSAtPSAxOyAvLyBUT0RPIHN0ZXA/XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBzZWxlY3RlZFBhZ2UgKz0gMTtcbiAgICAgIH1cbiAgICB9XG5cbiAgICB0aGlzLnNldFBhZ2Uoc2VsZWN0ZWRQYWdlKTtcbiAgfVxuXG4gIHNldFBhZ2UoaW5kZXgpIHtcbiAgICBpZiAoaW5kZXggPCAwKSB7XG4gICAgICBpbmRleCA9IDA7XG4gICAgfSBlbHNlIGlmIChpbmRleCA+PSB0aGlzLnN0YXRlLnBhZ2VDb3VudCkge1xuICAgICAgaW5kZXggPSB0aGlzLnN0YXRlLnBhZ2VDb3VudCAtIDE7XG4gICAgfVxuXG4gICAgdGhpcy5fc2Nyb2xsaW5nID0gdHJ1ZTtcblxuICAgIEFuaW1hdGVkLnNwcmluZyh0aGlzLnN0YXRlLm9mZnNldExlZnQsIHtcbiAgICAgIHRvVmFsdWU6IGluZGV4LFxuICAgICAgYm91bmNpbmVzczogMCxcbiAgICAgIHJlc3RTcGVlZFRocmVzaG9sZDogMVxuICAgIH0pLnN0YXJ0KCgpID0+IHtcblxuICAgICAgdGhpcy5fb25QYWdlU2Nyb2xsKHtcbiAgICAgICAgbmF0aXZlRXZlbnQ6IHtcbiAgICAgICAgICBwb3NpdGlvbjogaW5kZXgsXG4gICAgICAgICAgb2Zmc2V0OiAwXG4gICAgICAgIH1cbiAgICAgIH0pO1xuXG4gICAgICB0aGlzLl9zY3JvbGxpbmcgPSBmYWxzZTtcblxuICAgICAgdGhpcy5zZXRTdGF0ZSh7XG4gICAgICAgIHNlbGVjdGVkUGFnZTogaW5kZXhcbiAgICAgIH0sICgpID0+IHtcbiAgICAgICAgdGhpcy5wcm9wcy5vblBhZ2VTZWxlY3RlZCAmJiB0aGlzLnByb3BzLm9uUGFnZVNlbGVjdGVkKHtuYXRpdmVFdmVudDoge3Bvc2l0aW9uOiBpbmRleH19KTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbn07XG5cbm1peGluLm9uQ2xhc3MoVmlld1BhZ2VyLCBOYXRpdmVNZXRob2RzTWl4aW4pO1xuYXV0b2JpbmQoVmlld1BhZ2VyKTtcblxuVmlld1BhZ2VyLmlzUmVhY3ROYXRpdmVDb21wb25lbnQgPSB0cnVlO1xuXG5leHBvcnQgZGVmYXVsdCBWaWV3UGFnZXI7XG4iXX0=